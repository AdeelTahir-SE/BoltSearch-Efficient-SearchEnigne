[
    [
        {
            "Id": 274560,
            "CreationDate": "2008-11-08T09:36:32Z",
            "Score": 110,
            "Title": "How do you test a public/private DSA keypair?",
            "Body": "<p>Is there an easy way to verify that a given private key matches a given public key?  I have a few *.pub, and a few *.key files, and I need to check which go with which.</p>\n\n<p>Again, these are pub/key files, DSA.</p>\n\n<p>I would really prefer a one-liner of some sort...</p>\n",
            "Tag": "encryption,ssl,openssl,key",
            "Answer": "<p>Encrypt something with the public key, and see which private key decrypts it.</p>\n\n<p>This <a href=\"http://www.codeproject.com/KB/security/SimpleEncryption.aspx\" rel=\"nofollow\">code project article</a> by none other than Jeff Atwood implements a simplified wrapper around the .NET crypto classes. Assuming these keys were created for use with RSA, use the asymmetric class with your public key to encrypt, and the same with your private key to decrypt.</p>\n,,,,,<p>Assuming you have the public keys inside x.509 certificates, and assuming they are RSA keys, then for each public key, do</p>\n\n<pre><code>    openssl x509 -in certfile -modulus -noout\n</code></pre>\n\n<p>For each private key, do</p>\n\n<pre><code>    openssl rsa -in keyfile -modulus -noout\n</code></pre>\n\n<p>Then match the keys by modulus.</p>\n,,,,,<p>For DSA keys, use</p>\n\n<pre><code> openssl dsa -pubin -in dsa.pub -modulus -noout\n</code></pre>\n\n<p>to print the public keys, then</p>\n\n<pre><code> openssl dsa -in dsa.key -modulus -noout\n</code></pre>\n\n<p>to display the public keys corresponding to a private key, then compare them.</p>\n,,,,,<p>I found a way that seems to work better for me:</p>\n\n<pre><code>ssh-keygen -y -f &lt;private key file&gt;\n</code></pre>\n\n<p>that command will output the public key for the given private key, so then just compare the output to each *.pub file.</p>\n,,,,,<p>Delete the public keys and generate new ones from the private keys.  Keep them in separate directories, or use a naming convention to keep them straight.</p>\n,,,,,<p>I always compare an MD5 hash of the modulus using these commands:</p>\n\n<pre><code>Certificate: openssl x509 -noout -modulus -in server.crt | openssl md5\nPrivate Key: openssl rsa -noout -modulus -in server.key | openssl md5\nCSR: openssl req -noout -modulus -in server.csr | openssl md5\n</code></pre>\n\n<p>If the hashes match, then those two files go together.</p>\n,,,,,<p>Just use <a href=\"http://www.chiark.greenend.org.uk/~sgtatham/putty/download.html\" rel=\"nofollow\">puttygen</a> and load your private key into it. Offers different options, e.g. exporting the coressponding public key.</p>\n,,,,,<p>The check can be made easier with diff:</p>\n\n<pre><code>diff &lt;(ssh-keygen -y -f &lt;private_key_file&gt;) &lt;public key file&gt;\n</code></pre>\n\n<p>The only odd thing is that diff says nothing if the files are the same, so you'll only be told if the public and private <em>don't</em> match.</p>\n,,,,,<p>All of the above answers assume that the given private key - that you know nothing about and want to find out if it matches the given public key - HAS NO PASSPHRASE.  If the private key has a passphrase, then both</p>\n\n<p>ssh-keygen -y -f PRIVATEKEY</p>\n\n<p>and</p>\n\n<p>openssl (rsa or dsa) -in PRIVATEKEY -modulus -noout</p>\n\n<p>ask for the passphrase.  If you have an UNKNOWN private key, you don't know\nwhether it has a passphrase or not - let alone what the passphrase is if the key has one.</p>\n\n<p>So practically, it's worth trying the above commands, but if they then ask for a passphrase, you're stuck: you can't extract the public key and it's modulus to match with the second field on the public key file.  Does anyone know a way round this?</p>\n,,,,,<p>If you are in Windows and want use a GUI, with <a href=\"https://the.earth.li/~sgtatham/putty/latest/x86/puttygen.exe\" rel=\"nofollow\">puttygen</a> you can import your private key into it:</p>\n\n<p><a href=\"http://i.stack.imgur.com/8MfK5.png\" rel=\"nofollow\"><img src=\"http://i.stack.imgur.com/8MfK5.png\" alt=\"enter image description here\"></a></p>\n\n<p>Once imported, you can save its public key and compare it to yours.</p>\n",
            "combined_token_ids": "63853#, 20175#, 64891#, 140196#, 3104#, 4721633#, 58065#, 658918#, 1892719, 62555, 673255, 62825"
        }
    ],
    [
        {
            "Id": 822810,
            "CreationDate": "2009-05-05T00:47:27Z",
            "Score": 45,
            "Title": "iif equivalent in c#",
            "Body": "<p>Is there a <code>IIf</code> equivalent in <code>C#</code>? Or similar shortcut?</p>\n",
            "Tag": "c#,.net,ternary-operator,iif-function",
            "Answer": "<p>the ternary operator </p>\n\n<pre><code>bool a = true;\n\nstring b = a ? \"if_true\" : \"if_false\";\n</code></pre>\n,,,,,<p>It's the ternary operator <code>?</code></p>\n\n<pre><code>string newString = i == 1 ? \"i is one\" : \"i is not one\";\n</code></pre>\n,,,,,<p>VB.NET:</p>\n\n<pre><code>If(someBool, \"true\", \"false\")\n</code></pre>\n\n<p>C#</p>\n\n<pre><code>someBool ? \"true\" : \"false\";\n</code></pre>\n,,,,,<p>Also useful is the coalesce operator ??:</p>\n\n<p>VB:</p>\n\n<pre><code>Return Iif( s IsNot Nothing, s, \"My Default Value\" )\n</code></pre>\n\n<p>C#:</p>\n\n<pre><code>return s ?? \"My Default Value\";\n</code></pre>\n,,,,,<p>C# has the \"?\" ternary operator, like other C-style languages.  However, this is not perfectly equivalent to iif.  There are two important differences.</p>\n\n<p>To explain the first, this <code>iif()</code> call would cause a DivideByZero exception even though the expression is true because <code>iif</code> is just a function and all arguments must be evaluated before calling:</p>\n\n<pre><code>iif(true, 1, 1/0)\n</code></pre>\n\n<p>Put another way, iif does <em>not</em> short circuit in the traditional sense, as your question indicates.  On the other hand, this ternary expression does and so is perfectly fine:</p>\n\n<pre><code>(true)?1:1/0;\n</code></pre>\n\n<p>The other difference is that <code>iif</code> is not type safe.  It accepts and returns arguments of type <code>object</code>.  The ternary operator uses type inference to know what type it's dealing with.  Note that you can fix this very easily with a generic implementation, but out of the box that's the way it is.</p>\n\n<p>If you really want iif() in C#, you can have it:</p>\n\n<pre><code>object iif(bool expression, object truePart, object falsePart) \n{return expression?truePart:falsePart; }\n</code></pre>\n\n<p>or a generic/type-safe implementation:</p>\n\n<pre><code>T iif&lt;T&gt;(bool expression, T truePart, T falsePart) \n{ return expression?truePart:falsePart;}\n</code></pre>\n\n<p>On the other hand, if you want the ternary operator in VB, Visual Studio 2008 and later provide a new <code>If</code> <em>operator</em> that works more like C#'s ternary.  It uses type inference to know what it's returning, and it's an operator rather than a function so there's no pesky divide-by-zero issues.</p>\n,,,,,<pre><code>booleanExpression ? trueValue : falseValue;\n</code></pre>\n\n<p>Example:</p>\n\n<pre><code>string itemText = count &gt; 1 ? \"items\" : \"item\";\n</code></pre>\n\n<p><a href=\"http://zamirsblog.blogspot.com/2011/12/c-vb-equivalent-of-iif.html\" rel=\"nofollow\">http://zamirsblog.blogspot.com/2011/12/c-vb-equivalent-of-iif.html</a></p>\n,,,,,<p>It's limited in that you can't put statements in there. You can only put values(or things that return/evaluate to values),  to return</p>\n\n<p>This works ('a' is a static int within class Blah)</p>\n\n<pre><code>Blah.a=Blah.a&lt;5?1:8;\n</code></pre>\n\n<p>(round brackets are impicitly between the equals and the question mark).</p>\n\n<p>This doesn't work.</p>\n\n<pre><code>Blah.a = Blah.a &lt; 4 ? Console.WriteLine(\"asdf\") : Console.WriteLine(\"34er\");\nor\nBlah.a = Blah.a &lt; 4 ? MessageBox.Show(\"asdf\") : MessageBox.Show(\"34er\");\n</code></pre>\n\n<p>So you can only use the c# ternary operator for returning values.  So it's not quite like a shortened form of an if.  Javascript and perhaps some other languages let you put statements in there.</p>\n",
            "combined_token_ids": "58065#, 1856126#, 20365#, 3168#, 3168, 128465, 7167902, 3055347"
        }
    ],
    [
        {
            "Id": 1540920,
            "CreationDate": "2009-10-08T22:43:20Z",
            "Score": 2,
            "Title": "Using VB.NET If vs. IIf in binding/rendering expression",
            "Body": "<p>I'm trying to bind UI controls to a business object exposed as a property on an ASP.NET page in a null-safe manner.</p>\n\n<p>Using the 'If' operator is null-safe, but results in compiler error:</p>\n\n<p>Compiler Error Message: BC30201: Expression expected.</p>\n\n<p>Using 'IIf' succeeds, but isn't null-safe. I've tried both the render expression syntax ('&lt;%= %>') binding expression syntax ('&lt;%# %>'), but there was no difference.</p>\n\n<p>Can someone explain this inconsistency and perhaps provide an alternative?</p>\n\n<p>Sample code:</p>\n\n<p>This works:\n&lt;%=IIf(Me.Foo Is Nothing, \"\", Me.Foo.Id)%></p>\n\n<p>This throws the compiler error:\n&lt;%=If(Me.Foo Is Nothing, \"\", Me.Foo.Id)%></p>\n",
            "Tag": "vb.net",
            "Answer": "<p>you have to do something like</p>\n\n<pre><code>&lt;% if someCondition then %&gt;\nsome html here\n&lt;% end if %&gt;\n</code></pre>\n\n<p>no equals sign after the <code>&lt;%</code></p>\n,,,,,<p>When using <code>IIf</code>, both the \"true\" and the \"false\" expression are evaluated before calling IIf.</p>\n\n<p>It is the same as calling this function:</p>\n\n<pre><code>Public Function MyIIf(ByVal test As Boolean, ByVal trueOption As Object, ByVal falseOption As Object) As Object\n    If test Then Return trueOption Else Return falseOption\nEnd Function\n</code></pre>\n\n<p>So before <code>IIf</code> is being called, <code>Me.Foo.Id</code> is being evaluated and throws an exception.</p>\n\n<p>This is <em>not</em> the way that c#'s <a href=\"http://msdn.microsoft.com/en-us/library/ty67wk28%28VS.71%29.aspx\" rel=\"nofollow\">conditional (<code>?:</code>) operator</a> works.  Which is likely the source of confusion.</p>\n,,,,,<p>VB.NET now includes a short-circuiting IF() operator. if the first operator isn't true, the second is NEVER evaluated. This is completely different from the way that IIF works, and the way that any custom function you might write works. It is, in fact, equivalent to C#'s ?: operator.</p>\n\n<p>Documentation can be found here: \n<a href=\"http://msdn.microsoft.com/en-us/library/bb513985.aspx\" rel=\"nofollow\">IF operator on MSDN</a></p>\n,,,,,<p>How about</p>\n\n<pre><code>&lt;% if foo.me isnot nothing then response.write(me.foo.id) %&gt;\n</code></pre>\n,,,,,<p>Are you using VB2008? The <a href=\"http://msdn.microsoft.com/en-us/library/bb513985.aspx\" rel=\"nofollow\">If()</a> operator was <a href=\"http://blogs.msdn.com/vbteam/archive/2008/03/11/if-operator-a-new-and-improved-iif-sophia-salim.aspx\" rel=\"nofollow\">not available</a> in earlier versions of VB, which might explain your compiler error. </p>\n\n<p>In earlier versions of VB, I would use <a href=\"http://stackoverflow.com/questions/1540920/using-vb-net-if-vs-iif-in-binding-rendering-expression/1540932#1540932\">Jason's answer</a>.</p>\n\n<pre><code>&lt;% if someCondition then %&gt;\nsome html here\n&lt;% end if %&gt;\n</code></pre>\n,,,,,<p>Okay, revisiting the question, I think we may be barking up the wrong tree with IF(). The answer probably lies in the error message:</p>\n\n<blockquote>\n  <p>Compiler Error Message: BC30201:\n  Expression expected.</p>\n</blockquote>\n\n<p>So, I built a sample app. Standard Visual Studio 2008 Web application. I created a class named Bar and added it to my app_code folder:</p>\n\n<pre><code>Imports Microsoft.VisualBasic\n\nPublic Class Bar\n    Public Id As String\nEnd Class\n</code></pre>\n\n<p>In the default.aspx page, I added the following to the code-behind file:</p>\n\n<pre><code>Partial Class _Default\n    Inherits System.Web.UI.Page\n\n    Protected Foo As New Bar()\n\nEnd Class\n</code></pre>\n\n<p>Note that <code>Foo</code> is marked <code>protected</code>.</p>\n\n<p>In the page, I added the following code:</p>\n\n<pre><code>&lt;form id=\"form1\" runat=\"server\"&gt;\n&lt;div&gt;\n    &lt;%=If(Me.Foo Is Nothing, \"\", Me.Foo.Id)%&gt;\n&lt;/div&gt;\n&lt;/form&gt;\n</code></pre>\n\n<p>This works for me, and I get no errors whatsoever. If I then modify the code-behind as follows, I get the expected output (\"Something\" appears on a blank page):</p>\n\n<pre><code>Partial Class _Default\n    Inherits System.Web.UI.Page\n\n    Protected Foo As New Bar()\n\n    Public Sub New()\n        Foo.Id = \"Something\"\n    End Sub\n\nEnd Class\n</code></pre>\n\n<p>If this isn't working for you, then my suggestion to you is to <em>verify that you are targeting the .NET 3.5 Framework.</em> When I target .NET 2.0, I get \"Expression Expected\" on the IF() call. This error does not occur when targeting 3.5. </p>\n\n<p>You can verify that you are targeting 3.5 through the Build tab on the properties for your Web application.</p>\n",
            "combined_token_ids": "251185#, 389887#, 19365#, 3776#, 58065#, 20365#, 8307783#, 1883424#, 389887"
        }
    ],
    [
        {
            "Id": 1839530,
            "CreationDate": "2009-12-03T12:09:29Z",
            "Score": 0,
            "Title": "Are .Net's and Java's DSA implementation compatible?",
            "Body": "<p>I am trying to digitally sign requests made by a mobile client running J2ME and want to verify the signature by the .Net Framework. </p>\n\n<p>Does anyone know if the implementations </p>\n\n<pre><code>DSACryptoServiceProvider //.Net\n</code></pre>\n\n<p>and </p>\n\n<pre><code>Signature.getInstance(\"SHA1withDSA\", \"SUN\") //Java\n</code></pre>\n\n<p>are compatible? Or does anyone have a better idea?</p>\n\n<p><hr></p>\n\n<p>After some research I found this library which seems to have DSA APIs for both C# and Java with the same underlying implementations: <a href=\"http://www.bouncycastle.org\" rel=\"nofollow\">http://www.bouncycastle.org</a></p>\n\n<p>Does anyone have any experience with this?</p>\n",
            "Tag": ".net,java-me,sha1,digital-signature,dsa",
            "Answer": "<p>As I understand it, DSA/SHA1 are standard algorithms (or RFCs, but never mind), so it's more than likely they are interchangeable.</p>\n,,,,,<p>I had to deal with J2ME => .Net Web Service. And I had some problems with Encryption. I am not sure about DSA Java and .Net differs on encryption in DES and AES as far as I know. </p>\n\n<p>This does not answer to your question but I guess it may help you.</p>\n\n<p>There is a library named Bouncy Castle:</p>\n\n<p>Releases for Java:\n<a href=\"http://www.bouncycastle.org/latest%5Freleases.html\" rel=\"nofollow\">http://www.bouncycastle.org/latest%5Freleases.html</a>  (pick J2ME one)</p>\n\n<p>Releases for C#\n<a href=\"http://www.bouncycastle.org/csharp/\" rel=\"nofollow\">http://www.bouncycastle.org/csharp/</a></p>\n\n<p>I used them without any headache. Documentation is not poor but is not good also. But Java and C# versions are compatible. </p>\n,,,,,<p>They must be compatible, otherwise Java and .NET web-services wouldn't be, and I know for sure that they are</p>\n,,,,,<p>.NET and Java encode the signatures in different ways. Otherwise they should be compatible. <a href=\"http://stackoverflow.com/questions/1915535/dsa-problem-create-dsa-public-private-key-with-net-use-the-public-key-with-ja/1916908#1916908\">More details in another answer.</a></p>\n",
            "combined_token_ids": "58716#, 128465#, 57688#, 129626#, 58065#, 4936090#, 1792236#, 128465, 570949, 100805, 8452729, 58065"
        }
    ],
    [
        {
            "Id": 2747940,
            "CreationDate": "2010-04-30T21:58:42Z",
            "Score": 3,
            "Title": "Problem evaluating NULL in an IIF statement (Access)",
            "Body": "<p>Item in the recordset rstImportData(\"Flat Size\") is = Null</p>\n\n<p>With that, given the following statement:</p>\n\n<pre><code>IIF(IsNull(rstImportData(\"Flat Size\")), Null, cstr(rstImportData(\"Flat Size\")))\nResult: Throws error 94: Invalid use of Null\n</code></pre>\n\n<p>If I change the statement by removing the type conversion upon a false comparison:</p>\n\n<pre><code>IIF(IsNull(rstImportData(\"Flat Size\")), Null, 0)\nResult: Null\n</code></pre>\n\n<p>It returns Null as it should have the first time.  It appears that I cannot do a type conversion in an IIF if the value passed in should ever be null even if it passes an IIF test, it still attempts to evaluate it at both the true and false answer.  The only reason I'm using IIF like this is because I have a 25 line comparison to compare data from an Import against a matching record in a database to see if I need to append the prior to history.</p>\n\n<p>Any thoughts?  The way data is imported there will be null dates and where the spreadsheet import is in a string format I must convert either side to the other to compare the values properly but if either side is null this exception occurs :(</p>\n\n<p><em>EDIT</em>\nExample of why I was using IIF (and considering using a universal function)</p>\n\n<pre><code>If master(\"one\") &lt;&gt; import(\"one\") Or _\n   master(\"two\") &lt;&gt; import(\"two\") Or _\n   master(\"date\") &lt;&gt; import(\"date\") Or _  //import(\"date\") comes from a spreadsheet, it comes in as string, CAN be a null value\n   master(\"qty\") &lt;&gt; import(\"qty\") Or _    //import(\"qty\") comes from spreadsheet, comes in as a string can CAN be null\n   master(\"etc\") &lt;&gt; import(\"etc\") Then\n\n....stuff....\n\nEnd If\n</code></pre>\n\n<p>This code expands for roughly 20 columns to compare in the database.  I would prefer to check as part of the statement.  I can think of a bunch of solutions but they involve adding much more code.  If that is the case power to it, however I'm not one to give in so easily.</p>\n\n<p>Options I see are</p>\n\n<ul>\n<li>Creating temp vars to do the work prior to comparing and using these new vars instead of the recordset</li>\n<li>Creating an object to pass the record into to preformat and work with, though extra work would provide this functionality to each import type since there are different files with similar fields</li>\n</ul>\n\n<p>I'm here for ideas, and I'm open to any interesting pieces that can be thrown my way as I get to decide how to do it I'm looking for the most reusable approach.</p>\n",
            "Tag": "ms-access,vba,iif-function",
            "Answer": "<p>The behavior you described is the standard way IIf operates under VBA.  This is part of what Access 2003 Help says about it:</p>\n\n<p>\"<strong>IIf</strong> always evaluates both <strong><em>truepart</em></strong> and <strong><em>falsepart</em></strong>, even though it returns only one of them. Because of this, you should watch for undesirable side effects. For example, if evaluating <strong><em>falsepart</em></strong> results in a division by zero error, an error occurs even if <strong><em>expr</em></strong> is <strong>True</strong>.\"</p>\n\n<p>However, if you use an IIf statement in a query, evaluation short circuits after <strong><em>truepart</em></strong> when <strong><em>expr</em></strong> is <strong>True</strong> --- <strong><em>falsepart</em></strong> is not evaluated in that case.  Unfortunately this information is not useful for you ... unless you can incorporate a query into your comparison.</p>\n\n<p>I don't know of any other way to avoid your error with IIf.  I would try appending the Excel data into a table whose structure matches that of the table you will compare against, thereby eliminating the need to do a string conversion at the same time you do the comparison.</p>\n,,,,,<p>The simple expedient of changing the value to a string helps tremendously. The trick is that trimming a string which is NULL will get a null string. Which can then be operated on as if it wasn't a database null.<BR>\nI frequently use the form:<br></p>\n\n<pre><code>CInt(\"0\" &amp; Trim(SomeVariant &amp; \" \"))\n</code></pre>\n\n<p>To get a valid number without having to go through a bunch of hijinks. The null is a nonentity for this problem.</p>\n",
            "combined_token_ids": "646111#, 954911#, 136843#, 20365#, 19861#, 58065#, 1365849#, 1280#, 1287922, 56578, 3055347"
        }
    ],
    [
        {
            "Id": 4285740,
            "CreationDate": "2010-11-26T13:36:41Z",
            "Score": 1,
            "Title": "How to create a signature from Private Key? - DSA",
            "Body": "<p>I am trying to create a signature from a private key that i have been provided and a hashed value. I am using DSA and the following code but receive the following error:</p>\n\n<p>Invalid type specified.\nsource mscorlib</p>\n\n<p>The error is thrown on this line: ImportCspBlob(pk)</p>\n\n<pre><code> Private Function key() As String\n\n        Dim privatekey As String = \"-----BEGIN DSA PRIVATE KEY-----\" _\n        &amp; \"Key Data\"\n        &amp; \"-----END DSA PRIVATE KEY-----\"\n\n        Dim dsa As DSACryptoServiceProvider = New DSACryptoServiceProvider()\n        Dim pk As Byte() = Encoding.ASCII.GetBytes(privatekey)\n\n        dsa.ImportCspBlob(pk)\n        Dim st As Byte() = Encoding.ASCII.GetBytes(\"THIS IS THE HASH STRING\")))\n        Dim signedValue As Byte() = dsa.SignHash(st, \"SHA1\")\n\n        Return Encoding.ASCII.GetString(signedValue)\n\n    End Function\n</code></pre>\n\n<p>Can anyone tell me if I am on the right lines herE or  am I way out?</p>\n\n<p>Any help on this would be much appreciated.</p>\n",
            "Tag": ".net,vb.net,dsa",
            "Answer": "<p>You are using, as private key, a PEM-encoded object in a format which is mostly specific to OpenSSL. At its root, it is an ASN.1-based structure, encoded in DER, then re-encoded in Base64 (to make it ASCII-compatible), and finally equipped with some headers (the \"BEGIN DSA PRIVATE KEY\"). On the other hand, <code>ImportCsbBlob()</code> expects a bunch of bytes compatible with what <a href=\"http://msdn.microsoft.com/en-us/library/aa381988%28v=VS.85%29.aspx\" rel=\"nofollow\">CryptoAPI expects</a>: a custom, Microsoft-specific encoding of the DSA key elements.</p>\n\n<p>I have used an awful lot of acronyms in the paragraph above in order to underline the fact that converting from one encoding to another <em>is</em> a complex matter. Those things are heavily layered and very different from each other.</p>\n\n<p><a href=\"http://pumka.net/2009/12/19/reading-writing-and-converting-rsa-keys-in-pem-der-publickeyblob-and-privatekeyblob-formats/\" rel=\"nofollow\">This blob post</a> seems to tell that some very recent versions of <a href=\"http://www.openssl.org/\" rel=\"nofollow\">OpenSSL</a> can do the conversion for you.</p>\n",
            "combined_token_ids": "63853#, 21183#, 410572#, 3104#, 1366683#, 136712#, 655018#, 62825#, 1440#, 58065#, 128465, 389887, 58065"
        }
    ],
    [
        {
            "Id": 8131940,
            "CreationDate": "2011-11-15T05:34:25Z",
            "Score": 2,
            "Title": "sql iif statement join tables questions",
            "Body": "<p>I want to produce the result:</p>\n\n<pre><code>table name: HWData\npolicy number:        number of residents:   factor:\n100                     2                      1\n101                     4                      1.25\n102                     7                      2\n103                     99                     2\n104                     1                      0.85\n</code></pre>\n\n<p>using the rules:</p>\n\n<pre><code>table name: Tier_Occupancy\nnumber of residents:   factor:\n1                       0.85\n2                       1  \n3                       1.10\n4                       1.25\n5                       1.5\n6 or above              2.0\n</code></pre>\n\n<p>This is what I have so far:</p>\n\n<pre><code>SELECT \nHWData.[Policy Number], \niif( HWData.[Number of Residents] = 1, Tier_Occupancy.Factor,1 ), \niif( HWData.[Number of Residents] = 2, Tier_Occupancy.Factor, 1), \niif( HWData.[Number of Residents] = 3, Tier_Occupancy.Factor, 1), \niif( HWData.[Number of Residents] = 4, Tier_Occupancy.Factor, 1), \niif( HWData.[Number of Residents] = 5, Tier_Occupancy.Factor, 1), \niif( HWData.[Number of Residents] &gt;= 6, Tier_Occupancy.Factor, 1)\n\nFROM HWData \nINNER JOIN Tier_Occupancy ON HWData.[Number of Residents]=Tier_Occupancy.[Number of Residents]\n\nORDER BY HWData.[Policy Number];\n</code></pre>\n\n<p>My question is it does show the result but it shows <code>1 1 1 1 1 1</code> for policy number 100\nand it shows <code>1 1 1 1.25 1 1</code> for policy number 101 but I don't want that: I just want to show 1 for policy number 100 and 1.25 for policy number 101.</p>\n\n<p>I am using 2007 Microsoft Access's SQL.</p>\n",
            "Tag": "sql,sql-server,ms-access",
            "Answer": "<p>Replace this</p>\n\n<pre><code>iif( HWData.[Number of Residents] = 1, Tier_Occupancy.Factor,1 ), \niif( HWData.[Number of Residents] = 2, Tier_Occupancy.Factor, 1), \niif( HWData.[Number of Residents] = 3, Tier_Occupancy.Factor, 1), \niif( HWData.[Number of Residents] = 4, Tier_Occupancy.Factor, 1), \niif( HWData.[Number of Residents] = 5, Tier_Occupancy.Factor, 1), \niif( HWData.[Number of Residents] &gt;= 6, Tier_Occupancy.Factor, 1)\n</code></pre>\n\n<p>with this</p>\n\n<pre><code>Tier_Occupancy.Factor\n</code></pre>\n\n<p>The join needs to be fixed. It is where you need to use the IIF.</p>\n\n<pre><code>ON iif(HWData.[Number of Residents]&gt;5,6,HWData.[Number of Residents]) = Tier_Occupancy.[Number of Residents]\n</code></pre>\n\n<p>and drop the \" or above\" from the last entry in the Tier_Occupancy table's last \"number of residents\" entry. That should be a numeric column.</p>\n\n<p>Also, don't forget to select the number of residents column as you said you wanted in your result.</p>\n,,,,,<pre><code>SELECT \nHWData.[Policy Number], \n   (select top 1 Tier_Occupancy.Factor from Tier_Occupancy \n    where Tier_Occupancy.[Number of Residents] &lt;= HWData.[Number of Residents]\n   order by Tier_Occupancy.[Number of Residents] desc) as factor\nFROM HWData \n\nORDER BY HWData.[Policy Number];\n</code></pre>\n",
            "combined_token_ids": "62181#, 58065#, 1365849#, 134724#, 239375#, 987184#, 62181, 1804314, 1287922"
        }
    ],
    [
        {
            "Id": 8622580,
            "CreationDate": "2011-12-24T03:59:01Z",
            "Score": 19,
            "Title": "JavaScript: IIF like statement",
            "Body": "<p>Coming from VB, JavaScript isn't very easy to get the hang of. Please don't be negative, I've tried and searched loads but with no luck. BTW, I'm creating a dropdown control initialized from a <code>Select</code> option list in JS.</p>\n\n<p>Dummy code:</p>\n\n<pre><code>var col = 'tardis'; \nvar x = '&lt;option value=\"' + col + '\"&gt;Very roomy&lt;/option&gt;');\n</code></pre>\n\n<p>I would like to add <code>selected</code> after the value of col ONLY if col is equal to 'screwdriver'.</p>\n\n<p>I've tried using the IF statement with the ? and the : but can't seem to get my head around it. Having '' as the false value does not work. No items are selected and the list is blank. Remove the IF statement and all works.</p>\n\n<p>Any ideas and again, sorry for the newb-ness.</p>\n",
            "Tag": "javascript,inline,iif",
            "Answer": "<pre><code>var x = '&lt;option value=\"' + col + '\"'\nif (col == 'screwdriver') x += ' selected';\nx += '&gt;Very roomy&lt;/option&gt;';\n</code></pre>\n,,,,,<p>Something like this:</p>\n\n<pre><code>for (/* stuff */)\n{\n    var x = '&lt;option value=\"' + col + '\" '\n        + (col === 'screwdriver' ? 'selected' : '')\n        + '&gt;Very roomy&lt;/option&gt;';\n    // snip...\n}\n</code></pre>\n,,,,,<p>I typed this in my URL bar:</p>\n\n<pre><code>javascript:{ var col = 'screwdriver'; var x = '&lt;option value=\"' + col + '\"' + ((col == 'screwdriver') ? ' selected' : '') + '&gt;Very roomy&lt;/option&gt;'; alert(x); }\n</code></pre>\n,,,,,<pre><code>'&lt;option value=\"' + col + '\"'+ (col === \"screwdriver\" ? \" selected \" : \"\") +'&gt;Very roomy&lt;/option&gt;';\n</code></pre>\n,,,,,<p>If your end goal is to add elements to your page, just manipulate the DOM directly.  Don't use string concatenation to try to create HTML - what a pain!  See how much more straightforward it is to just create your element, instead of the HTML that represents your element:</p>\n\n<pre><code>var x = document.createElement(\"option\");\nx.value = col;\nx.text = \"Very roomy\";\nx.selected = col == \"screwdriver\";\n</code></pre>\n\n<p>Then, later when you put the element in your page, instead of setting the <code>innerHTML</code> of the parent element, call <code>appendChild()</code>:</p>\n\n<pre><code>mySelectElement.appendChild(x);\n</code></pre>\n",
            "combined_token_ids": "1866349#, 58065#, 129753#, 1365849#, 1866349, 414489, 58065"
        }
    ],
    [
        {
            "Id": 8917670,
            "CreationDate": "2012-01-18T21:25:21Z",
            "Score": 0,
            "Title": "IIF IsNothing expression example",
            "Body": "<p>I'm using <code>SSRS 2008</code> and am trying to create an <code>expression</code> where if date field A is greater than date field B or date field A is NULL then this filter will select this record.  How do I do this?</p>\n\n<p>I tried this expression to select <code>NULL</code> date fields, but it is not working.  I set the datatype to \"Text\" for now--should I set this to boolean instead?  If so, then how can I modify this expression?</p>\n\n<pre><code>=iif(isnothing(Fields!A_date.Value),\"yes\",\"no\")\n</code></pre>\n",
            "Tag": "ssrs-2008,ssrs-expression",
            "Answer": "<pre><code>=IIF((CDATE(Fields!A_date.Value)&gt;CDate(Fields!B_date.Value)) OR ISNothing(Fields!A_date.Value),\"Yes\",\"NO\")\n</code></pre>\n\n<p>Try this !!!</p>\n",
            "combined_token_ids": "58065#, 1355524#, 1883424#, 648059#, 808690, 6029868"
        }
    ],
    [
        {
            "Id": 9368620,
            "CreationDate": "2012-02-20T21:24:23Z",
            "Score": 1,
            "Title": "DSA vs RSA and AES128 vs AES256 encryption in Java",
            "Body": "<p>DSA &amp; RSA</p>\n\n<p>It's not about which one is stronger.</p>\n\n<p>I've been researching the subject on the internet and below is the summary of information I've got.\nCan you please advise if it is correct or not, and if there are any additional important issues which I don't mention here.</p>\n\n<p>Here I am talking only about DSA vs RSA in application to Java.\nMy main goal - to use Public key algorithm to send Session key (AES) from client to server and then to check authencity of client.</p>\n\n<p>DSA.\n<BR>1. In Java you're are supposed to encrypt the file with private key.\n<BR>2. It means that IT IS a signature - anyone with a public key can read it, but only the owner can sign it.\n<BR>3. If you try using public key as private and vice versa, you'll run into trouble, because it is not that difficult to guess public key by private.\n<BR>4. You effectively can't use DSA to send Session key, because everyone will be able to decrypt it.</p>\n\n<p>RSA.\n<BR>1. In Java you're are supposed to encrypt file with public key.\n<BR>2. It means that this is best way to deliver secret messages to one specific recepient. Nobody can read it after being signed, except for the owner.\n<BR>3. If you try switching keys with each other it will bring troubles (the same as above)\n<BR>4. You can effectively use RSA for a client to send Session key encrypted with Server's open key and then receive confirmation from servers signed with Client's open key.</p>\n\n<p>Based on this I decided to use RSA for my purposes.</p>\n\n<p>AES256 vs AES128</p>\n\n<p>Another unrelated question - do you think that for session encryption without any extremely sensitive data it makes sense to use AES256?</p>\n\n<p>I'd like to, but it creates problems for end user. I know it is very easy to install update to Java which allows 256 bit keys, but the sad truth is that even such simple thing can cut potential userbase by half.</p>\n\n<p>On the other hand - if I don't send sensitive information (like credit card numbers) and each key is used for not more than a few days, maybe AES128 is enough?</p>\n\n<p>Obviously I am going to include the option to use AES256 for those users who are not bothered by the need to install update.</p>\n\n<p>Thanks for any comments!</p>\n",
            "Tag": "java,client-server,rsa,aes,dsa",
            "Answer": "<p>DSA means \"Digital Signature Algorithm\". It's meant for signatures. You <em>cannot</em> use it to encrypt anything.</p>\n\n<p>AES128 is <em>plenty</em> secure enough for sensitive information. Even the US government allows its use for anything except information classified as TOP SECRET, and that only because of a \"better safe than sorry\" mentality and considering that such information may still be harmful if decoded 50 years from now. I wouldn't hesitate a second to use it for transmitting credit card numbers (which, after all, expire in less than 10 years).</p>\n,,,,,<p>As you found out, DSA is only a signature algorithm, not a encryption one, and as such not suitable for key exchange.</p>\n\n<p>If you have a online connection (and not just transport from one point to another), you can use Diffie-Hellman (which is based on similar ideas like DSA), and use DSA or RSA in signature mode to authenticate the other side to avoid a man-in-the-middle attack.</p>\n\n<p>Other than that, RSA key exchange is also quite usual (i.e. sending the key AES key encrypted with the RSA key of the server).</p>\n\n<p>For the AES variants, AES-128 should be secure for about any time (i.e. bruteforcing should take longer than you'll live). There is only a larger key variant as the US military wanted to use different levels of security for different stuff. (And also, AES-256 is lately showing some (theoretical) weaknesses which are not in AES-128, which could mean that AES-128 is actually more secure.)</p>\n\n<p>But as Kerrek commented, <strong>don't try to invent your own protocol</strong>, use existing ones. You will make all mistakes the other ones did before, and add new ones. (You can do your own implementation of these protocols if you want, but it is also often easier and safer to reuse existing implementations, too - there are lots of things to do wrong even with secure protocols, like using bad random numbers.)</p>\n\n<p>For online (two-sided) communication, SSL (or now better its successor TLS) is the way to go. In Java, it is available as the <a href=\"http://docs.oracle.com/javase/6/docs/api/index.html?javax/net/ssl/SSLEngine.html\" rel=\"nofollow\"><code>SSLEngine</code></a> class (if you want to use asynchronous I/O), or with a <code>SSL(Server)SocketFactory</code> (for normal socket read/write). I used this for applet/server communication (for my project <a href=\"http://www.fencing-game.de/\" rel=\"nofollow\">fencing-game</a>).</p>\n\n<p>For offline (one-directed) communication (like e-mail) or storage, use the PGP data format (which also can use RSA and AES). (I don't know of an existing Java implementation, though.)</p>\n",
            "combined_token_ids": "58065#, 3776#, 59381#, 57688#, 265704#, 267008#, 1892719#, 20365#, 129626#, 129626, 3852415, 59381, 60205, 58065"
        }
    ],
    [
        {
            "Id": 12969180,
            "CreationDate": "2012-10-19T07:15:11Z",
            "Score": 0,
            "Title": "DSA and Public Key Exchange",
            "Body": "<p>I am trying to implement a licensing solution with DSA Algorithms for my application. Now here is what I have done:</p>\n\n<ol>\n<li>Generated a hardware key, taken its hash.</li>\n<li>Generated public and private keys. And encrypted my hash function with private key. </li>\n<li>I forward this encrypted value back to client along with the public key.</li>\n<li>At client's system, I use the DSASignatureDeformatter's VerifySignature function to validate my encrypted key, and my hardware key. If equal I validate the client.</li>\n</ol>\n\n<p>Now my problem is that how to send the public key over the network. I tried to store and forward various DSAParameters values e.g., J, G, P in a file but since the sizes of keys change, that is not viable. Please see if anyone can guide.</p>\n\n<p>Updated:\nWhen I try to do this at the client's machine</p>\n\n<pre><code>    DSAParameters KeyInfo;\n    using (DSACryptoServiceProvider DSA = new DSACryptoServiceProvider())\n    {\n\n        // Import the key information.\n        KeyInfo = DSA.ExportParameters(false);\n    }\n</code></pre>\n\n<p>The key size it generates for its various members is different from the public key parameters I have sent it back from server.</p>\n",
            "Tag": "c#,.net,dsa",
            "Answer": "<p>Okay. A bit late. But maybe other ones will have the same question.</p>\n\n<p>You should just export your key like this:</p>\n\n<pre><code>string publicKey = DSA.ToXmlString(false);\n</code></pre>\n\n<p>so you can import it like this:</p>\n\n<pre><code>using (DSACryptoServiceProvider dsa = new DSACryptoServiceProvider())\n{\n    dsa.FromXmlString(publicKey);\n    return dsa.VerifySignature()\n}\n</code></pre>\n",
            "combined_token_ids": "58065#, 57688#, 408165#, 62825#, 925379#, 3168, 128465, 58065"
        }
    ],
    [
        {
            "Id": 15506710,
            "CreationDate": "2013-03-19T17:43:57Z",
            "Score": 0,
            "Title": "CASE conversion from IIF",
            "Body": "<p>I started off with SQL (access)</p>\n\n<pre><code>IIf(Len([CAT]) &lt; 3, \nLeft([CAT],1) &amp; 0 &amp; Right([CAT],1),\n[CAT]) AS CAT1, \n[HD0] &amp;\n\nIIf([TABLE].[HD1]&lt;&gt;\"00\",\n\" / \" &amp; [HD1_ABR],\nNull) &amp; \nIIf([HD2]&lt;&gt;\"00\",\n\" / \" &amp; [HD2_NAME],\nNull) &amp; \nIIf([HD3]&lt;&gt;\"000\",\n\" / \" &amp; [HD3_NAME],\nNull) &amp; \nIIf([HD4]&lt;&gt;\"00\",\n\" / \" &amp; [HD4_NAME]) AS NAME,\n</code></pre>\n\n<p>and did Oracle (Sql Developer)</p>\n\n<pre><code>Case\nWhen length(cat) &lt; 3\nThen SubStr(cat,1,1) || '0' || SubStr(cat,-1,1)\nElse cat\nEnd cat1,hd0\nCase\nWhen TABLE &lt;&gt;\"00\"\nthen \" / \"\nelse HD1_ABR,null\n</code></pre>\n\n<p>When I run query in SQLDev I get error\nError at Command Line:9 Column:4\nError report:\nSQL Error: ORA-00923: FROM keyword not found where expected\n00923. 00000 -  \"FROM keyword not found where expected\"</p>\n",
            "Tag": "sql,oracle,ms-access,oracle-sqldeveloper",
            "Answer": "<p>MS Access syntax is entirely different to Oracle syntax. No square brackets, and different names for the SQL functions. <a href=\"http://docs.oracle.com/cd/E11882_01/server.112/e17118/functions.htm#SQLRF006\" rel=\"nofollow\">http://docs.oracle.com/cd/E11882_01/server.112/e17118/functions.htm#SQLRF006</a></p>\n\n<pre><code> Case\n   When length(cat) &lt; 3\n   Then SubStr(cat,1,1) || '0' || SubStr(cat,-1,1)\n   Else cat\n End cat1\n</code></pre>\n",
            "combined_token_ids": "129620#, 1878454#, 136712#, 58065#, 62181, 404622, 1287922, 11810249"
        }
    ],
    [
        {
            "Id": 15824380,
            "CreationDate": "2013-04-05T01:17:50Z",
            "Score": -2,
            "Title": "Need to make Sum IIF query in linq vb.net",
            "Body": "<p>I am new with the linq and i need to do this query with linq in vb.net from a data table</p>\n\n<p>Every column are setted to VAR CHAR if its useful for the query:</p>\n\n<pre><code>SELECT Sum(IIf([ColumnNameToCountValues] IN \n    ('value1','value2','value3') \n     And [EmployeId] Like '[IDvalue]' \n     And [PROJECT] LIKE '[ProjectName]',1,0)) \n    AS Total FROM [DatatableName];\n</code></pre>\n\n<p>This query should return an integer.</p>\n",
            "Tag": "vb.net",
            "Answer": "<p>where are your error and what are your question also what have you tried? From what you have said <code>\"This query should return an integer.\"</code> May be your output got error, isn't it?\nSo, why not just change your database column data type to <code>INT</code></p>\n",
            "combined_token_ids": "126272#, 21183#, 127886#, 63209#, 58065#, 265771#, 20365#, 136836#, 389887#, 389887"
        }
    ],
    [
        {
            "Id": 16525310,
            "CreationDate": "2013-05-13T15:06:10Z",
            "Score": 2,
            "Title": "Encrypt a DSA private key with RSA public key",
            "Body": "<p>I want to encrypt the DSA secret key with the RSA public key using java. However, when I do so, I get this error:</p>\n\n<pre><code>javax.crypto.IllegalBlockSizeException: Data must not be longer than 245 bytes\n  at com.sun.crypto.provider.RSACipher.doFinal(RSACipher.java:337)\n  at com.sun.crypto.provider.RSACipher.engineDoFinal(RSACipher.java:382)\n</code></pre>\n\n<p>DSA and RSA key size is set to 1024 and 2048 respectively. I know that using RSA we cannot encrypt messages having size more than the RSA key size. However, in this case, DSA key size is less than RSA key size.</p>\n\n<p>I guess the problem is related to the getEncode() function because when I checked the return value of this function, I understood that the size of result is 335 byte.</p>\n\n<p><strong>I want to know how I can fix this problem? (I do not want to increase RSA the key size). I set DSA key size to 1024. Why DSA key size has the size of 335 byte after encoding?</strong></p>\n\n<p>DSA and RSA keygen functions as well as RSA encryption functions are as follow:</p>\n\n<pre><code>public static KeyPair generateDSAKey() {\n    KeyPair pair = null;\n    try {\n        KeyPairGenerator keyGen = KeyPairGenerator\n                .getInstance(\"DSA\", \"SUN\");\n        SecureRandom random = SecureRandom.getInstance(\"SHA1PRNG\", \"SUN\");\n        keyGen.initialize(1024, random);\n        pair = keyGen.generateKeyPair();\n    } catch (Exception e) {\n        e.printStackTrace();\n    }\n    return pair;\n}\npublic static KeyPair generateRSAKey() {\n    KeyPairGenerator kpg;\n    KeyPair kp = null;\n    try {\n        kpg = KeyPairGenerator.getInstance(\"RSA\");\n        kpg.initialize(2048);\n        kp = kpg.genKeyPair();\n    } catch (NoSuchAlgorithmException e) {\n        e.printStackTrace();\n    }\n    return kp;\n}\n\npublic static byte[] encryptRSA(byte[] msg, PublicKey pubKey) {\n    byte[] cipherData = null;\n    try {\n        Cipher cipher = Cipher.getInstance(\"RSA\");\n        cipher.init(Cipher.ENCRYPT_MODE, pubKey);\n        cipherData = cipher.doFinal(msg);\n    } catch (Exception e) {\n        e.printStackTrace();\n    }\n    return cipherData;\n}\n</code></pre>\n\n<p>and I call this function for encrypting DSA key with RSA public key:</p>\n\n<pre><code>PrivateKey WSK = Crypto.generateDSAKey().getPrivate();\nencWSK = encryptRSA(WSK.getEncoded(), RSAPublicKey);\n</code></pre>\n",
            "Tag": "java,encryption,rsa,dsa",
            "Answer": "<p>A DSA private key contains the algorithm parameters as well as the <em>x</em> value. Below is an example of a private key printed to stdout:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>Sun DSA Private Key \nparameters:\n    p:\n    fd7f5381 1d751229 52df4a9c 2eece4e7 f611b752 3cef4400 c31e3f80 b6512669\n    455d4022 51fb593d 8d58fabf c5f5ba30 f6cb9b55 6cd7813b 801d346f f26660b7\n    6b9950a5 a49f9fe8 047b1022 c24fbba9 d7feb7c6 1bf83b57 e7c6a8a6 150f04fb\n    83f6d3c5 1ec30235 54135a16 9132f675 f3ae2b61 d72aeff2 2203199d d14801c7\n    q:\n    9760508f 15230bcc b292b982 a2eb840b f0581cf5\n    g:\n    f7e1a085 d69b3dde cbbcab5c 36b857b9 7994afbb fa3aea82 f9574c0b 3d078267\n    5159578e bad4594f e6710710 8180b449 167123e8 4c281613 b7cf0932 8cc8a6e1\n    3c167a8b 547c8d28 e0a3ae1e 2bb3a675 916ea37f 0bfa2135 62f1fb62 7a01243b\n    cca4f1be a8519089 a883dfe1 5ae59f06 928b665e 807b5525 64014c3b fecf492a\n\nx:     1f853beb d6e30242 cd12bd28 e7055830 22ac43a8\n</code></pre>\n\n<p>You could simply encrypt <a href=\"http://docs.oracle.com/javase/7/docs/api/java/security/interfaces/DSAPrivateKey.html#getX%28%29\" rel=\"nofollow\">the <em>x</em> value</a>, however that assumes your recipient already knows the algorithm parameters <em>p</em>, <em>q</em> and <em>g</em>.</p>\n\n<p>Or you can send the <em>x</em> value encrypted and the parameters unencrypted (<a href=\"http://stackoverflow.com/questions/16525310/encrypt-a-dsa-private-key-with-rsa-public-key/16529684?noredirect=1#comment23740153_16529684\">thanks GregS</a>).</p>\n",
            "combined_token_ids": "687144#, 3104#, 58065#, 655018#, 62825#, 135976#, 59381#, 408165#, 129626, 1892719, 59381, 58065"
        }
    ],
    [
        {
            "Id": 16652900,
            "CreationDate": "2013-05-20T15:28:17Z",
            "Score": 0,
            "Title": "IIF THEN MS ACCESS 2010",
            "Body": "<p>This code has always stumped me, I have two training courses I am trying to find records of which employee has taken them, The code is:</p>\n\n<pre><code>SELECT O896IA_VEMPPRSA.EMP_NA, O867IA_VTRAING.SYS_EMP_ID_NR, O867IA_VTRAING.REG_NR,     \nO867IA_VTRAING.DIS_NR, O867IA_VTRAING.TNG_SYS_NR\nFROM O896IA_VEMPPRSA INNER JOIN O867IA_VTRAING ON O896IA_VEMPPRSA.SYS_EMP_ID_NR =     \nO867IA_VTRAING.SYS_EMP_ID_NR\nWHERE (((O896IA_VEMPPRSA.EMP_EMT_STS_CD)&lt;&gt;\"T\"))\nGROUP BY O896IA_VEMPPRSA.EMP_NA, O867IA_VTRAING.SYS_EMP_ID_NR, O867IA_VTRAING.REG_NR,     \nO867IA_VTRAING.DIS_NR, O867IA_VTRAING.TNG_SYS_NR;\n</code></pre>\n\n<p>I need to find the TNG_SYS_NR 1095 or 1743. If they have the record then I need a Y and if not I need it to show N.</p>\n\n<p>I need it to show Name, ID, Reg, Dis, 1095 Y or N, 1743 Y or N. So if they took both courses I need just one row with all their data and Y for 1743 &amp; for 1095. Right now it shows an employee listed twice with Y for 1095 N 1743 and N for 1095 Y 1743 if they took both.</p>\n\n<pre><code>+-----------------------------------+--------------------------------+--------+--------+------+------+\n|                EMP_NA             |                  SYS_EMP_ID_NR | REG_NR | DIS_NR | 1095 | 1743 |\n+-----------------------------------+--------------------------------+--------+--------+------+------+\n|     AMOS,  SHARNELE               |                    1531218     |     20 |     10 | N    | Y    |\n|     AMOS,  SHARNELE               |                    1531218     |     20 |     10 | Y    | N    |\n|     ANDERSON JERNAGIN,  SHERRY    |                    0354362     |     25 |     80 | N    | Y    |\n|     ANDERSON JERNAGIN,  SHERRY    |                    0354362     |     25 |     80 | Y    | N    |\n|     BAILEY,  EDWARD               |                    0070433     |     20 |     10 | N    | Y    |\n|     BAILEY,  EDWARD               |                    0070433     |     20 |     10 | Y    | N    |\n+-----------------------------------+--------------------------------+--------+--------+------+------+\n</code></pre>\n",
            "Tag": "vba,ms-access",
            "Answer": "<p>You should be able to use <code>IIF()</code> to get the calculated result:</p>\n\n<pre><code>IIF(O867IA_VTRAING.TNG_SYS_NR IN (1095, 1743), 'Y', 'N') \n</code></pre>\n\n<p>So if you add this to your query it would be:</p>\n\n<pre><code>SELECT DISTINCT O896IA_VEMPPRSA.EMP_NA, \n    O867IA_VTRAING.SYS_EMP_ID_NR, \n    O867IA_VTRAING.REG_NR,     \n    O867IA_VTRAING.DIS_NR, \n    IIF(O867IA_VTRAING.TNG_SYS_NR IN (1095, 1743), 'Y', 'N') \nFROM O896IA_VEMPPRSA \nINNER JOIN O867IA_VTRAING \n    ON O896IA_VEMPPRSA.SYS_EMP_ID_NR = O867IA_VTRAING.SYS_EMP_ID_NR\nWHERE (((O896IA_VEMPPRSA.EMP_EMT_STS_CD)&lt;&gt;\"T\"));\n</code></pre>\n\n<p>Edit, based on your changes you should be able to use an aggregate function around the IIF:</p>\n\n<pre><code>SELECT O896IA_VEMPPRSA.EMP_NA, \n  O867IA_VTRAING.REG_NR, \n  O867IA_VTRAING.DIS_NR,\n  max(IIF(O867IA_VTRAING.TNG_SYS_NR IN (1095), 'Y', 'N')) as Class1095 ,\n  Max(IIF(O867IA_VTRAING.TNG_SYS_NR IN (1743), 'Y', 'N'))  as Class1743\nFROM O896IA_VEMPPRSA \nINNER JOIN O867IA_VTRAING \n  ON O896IA_VEMPPRSA.SYS_EMP_ID_NR = O867IA_VTRAING.SYS_EMP_ID_NR\ngroup by O896IA_VEMPPRSA.EMP_NA, O867IA_VTRAING.REG_NR, O867IA_VTRAING.DIS_NR\n</code></pre>\n",
            "combined_token_ids": "58065#, 132739#, 21242#, 421172#, 60335#, 56578, 1287922"
        }
    ],
    [
        {
            "Id": 17383570,
            "CreationDate": "2013-06-29T18:43:28Z",
            "Score": 0,
            "Title": "iif in query expression to return multiple parts",
            "Body": "<p>I have a combobox that you can select a location, 1-7, and then a query based on that location is used as a record source for a report.  However, I also want to be able to see all...  So, I have a line of code like:</p>\n\n<pre><code>iif(Forms!ReportCreator.Location.Value&gt;0,Forms!ReportCreator.Location.Value,\"\")\n</code></pre>\n\n<p>However, I can't get it to show all if '0' is selected.  0 is the combobox value for 'All'</p>\n\n<p>I understand why it won't work, I am trying to say in SQL:</p>\n\n<pre><code>WHERE SampleLocation = \"\"\n</code></pre>\n\n<p>which doesn't give me what I want.  I have tried </p>\n\n<pre><code>\"1 OR 2 OR 3 OR 4 OR 5 OR 6 OR 7\" \n</code></pre>\n\n<p>in place of the \"\" in the iff statement, but it still doesn't work....  any suggestions?</p>\n",
            "Tag": "sql,vba,ms-access,ms-access-2007,access-vba",
            "Answer": "<p>One way is to embed the <code>WHERE</code> within the iif:</p>\n\n<pre><code>iif(Forms!ReportCreator.Location.Value&gt;0,\" WHERE SampleLocation = \" _ \n    &amp; Forms!ReportCreator.Location.Value,\"\")\n</code></pre>\n\n<p>although it depends how you are constructing your statement.</p>\n,,,,,<p>The asterisk wildcard character may be what you need.</p>\n\n<pre><code>Iif(Forms!ReportCreator.Location.Value&gt;0,Forms!ReportCreator.Location.Value,\"*\")\n</code></pre>\n\n<p>If that isn't the solution, then I suggest you try some variants for trouble-shooting, such as:</p>\n\n<pre><code>Iif(Forms!ReportCreator.Location.Value=1,\"2\",\"3\")\nIif(Forms!ReportCreator.Location.Value=0,\"2\",\"3\")\nIif(Forms!ReportCreator.Location.Value&lt;&gt;0,\"2\",\"3\")\n</code></pre>\n,,,,,<p>If you create the SQL command with VBA then it would be:</p>\n\n<pre><code>strSQL = \"SELECT ... WHERE SampleLocation = \" &amp; _\n          Iif(Forms!ReportCreator.Location.Value &gt; 0, _\n          Forms!ReportCreator.Location.Value,\"SampleLocation\")\n</code></pre>\n\n<p>If you want to do it directly in the SQL command it would be:</p>\n\n<pre><code>SELECT ...\nWHERE SampleLocation = iif(Forms!ReportCreator.Location.Value &gt; 0,\n                           Forms!ReportCreator.Location.Value,SampleLocation)\n</code></pre>\n\n<p>In both cases you get either the specified location or all locations.</p>\n",
            "combined_token_ids": "58065#, 20365#, 265771#, 1883424#, 21183#, 440004#, 966092#, 138327#, 62181, 56578, 1287922, 3292163, 1666304"
        }
    ],
    [
        {
            "Id": 19497830,
            "CreationDate": "2013-10-21T14:53:49Z",
            "Score": 0,
            "Title": "SSRS IIF statement issue",
            "Body": "<p>Trying to figure out why my IIF statement is not populating anything, and I'm sure it's something incorrect.  I am trying to display a row only if the Team is \"A Team\" and the StatusID is 10, and here is the expression.</p>\n\n<pre><code>=iif((Fields!Team.Value=\"A Team\") and (Fields!StatusID.Value=10), True,False)\n</code></pre>\n",
            "Tag": "sql,variables,reporting-services,reporting",
            "Answer": "<p>Try</p>\n\n<pre><code>=iif((Fields!Team.Value LIKE \"%A%\") and (Fields!StatusID.Value=10), True,False)\n</code></pre>\n\n<p>If that works try taking off the wildcards one by one and see if that still works or adding Team and the space, it could be the spacing or formating of the Team.  </p>\n,,,,,<p>SSRS is case sensitive. Try this<BR>\n<code>=iif((UCASE$(Fields!Team.Value) LIKE \"A%TEAM\") and (Fields!StatusID.Value=10), True,False)</code></p>\n",
            "combined_token_ids": "142687#, 58065#, 1365849#, 256768#, 62181, 921166, 9996237, 1369202"
        }
    ],
    [
        {
            "Id": 19524270,
            "CreationDate": "2013-10-22T17:13:47Z",
            "Score": 0,
            "Title": "IIF multi row evaluation",
            "Body": "<p>Is there a way to \"checkmark\" multiple rows in a table in an RDLC? Each of the below IIF statements is in a different row. if paytype is hourly, and time and half, and double, I would want the table to \"x\" the three rows HOURLY, TIME AND HALF, and DOUBLE. </p>\n\n<pre><code>IIF(Fields!payType = \"New\", \"X\", \" \")\nIIF(Fields!payType = \"Time and Half\", \"X\", \" \")\nIIF(Fields!payType = \"Double\", \"X\", \" \")\n</code></pre>\n",
            "Tag": "asp.net,sql,rdlc",
            "Answer": NaN,
            "combined_token_ids": "58065#, 257235#, 64793#, 1854260#, 611552, 62181, 128637"
        }
    ],
    [
        {
            "Id": 19739310,
            "CreationDate": "2013-11-02T05:42:28Z",
            "Score": 6,
            "Title": "White spaces when updating varchar field using iif in firebird",
            "Body": "<p>I see strange result when executing this query </p>\n\n<pre><code>update sd_invodt set line_type=iif(is_promo=1, 'campaign', 'item')\n</code></pre>\n\n<p>The value in line_type field will be <code>\"item   \"</code>. There are whitespaces in value.\nBut when I execute this query </p>\n\n<pre><code>update sd_invodt set line_type='item'\n</code></pre>\n\n<p>I don't get white spaces.</p>\n\n<p>Now I have to use trim as workaround </p>\n\n<pre><code>update sd_invodt set line_type=trim(iif(is_promo=1, 'campaign', 'item'))\n</code></pre>\n\n<p>I use latest firebird 2.5. Line_type is a varchar(15).</p>\n\n<p>Is this bug in Firebird?</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>I have tested using new database, and the problem persists.</p>\n",
            "Tag": "sql,firebird,firebird2.5",
            "Answer": "<p>The result type of the <code>iif()</code> depends on input and in case of string the result type seems to be <code>char(x)</code> where <code>x</code> is the length of the longest input string. Thus the <code>\"item\"</code> will be padded with 4 spaces to make it as long as the \"campaign\" is. I think this is by design but you may want to enter an ticket to the <a href=\"http://tracker.firebirdsql.org\" rel=\"nofollow\">FB issuetracker</a>.</p>\n\n<p>So the <code>iif()</code> return <code>\"item    \"</code> in case of first parameter being false and when you store spaces onto <code>varchar</code> field they are preserved.</p>\n",
            "combined_token_ids": "250250#, 237829#, 133114#, 412633#, 640893#, 240301#, 60783#, 58065#, 20365#, 937287#, 62181, 937287, 1797717"
        }
    ],
    [
        {
            "Id": 20440570,
            "CreationDate": "2013-12-07T11:06:00Z",
            "Score": 2,
            "Title": "RSA / DSA implementation in the Forth language",
            "Body": "<p>I need to develop a <a href=\"http://en.wikipedia.org/wiki/Pretty_Good_Privacy\" rel=\"nofollow\">PGP</a> implementation for a custom <a href=\"http://en.wikipedia.org/wiki/Forth_%28programming_language%29\" rel=\"nofollow\">Forth</a> kernel, and I was wondering if anyone could give me pointers as to where I could get an <a href=\"http://en.wikipedia.org/wiki/RSA_%28cryptosystem%29\" rel=\"nofollow\">RSA</a>/<a href=\"http://en.wikipedia.org/wiki/Digital_Signature_Algorithm\" rel=\"nofollow\">DSA</a> implementation in (any) Forth to use for the project.</p>\n\n<p>I prefer source code with a flexible license that allows me to use it for whatever I desire. This will save me a lot of hours in coding my own RSA/DSA algorithm which will then take days to debug and mature into something stable.</p>\n\n<p>In addition, where can I get and RSA/DSA implementation in pure assembly for the x86 architecture 32/64 bit, preferably in Intel syntax for <a href=\"http://en.wikipedia.org/wiki/Netwide_Assembler\" rel=\"nofollow\">NASM</a> as an alternative to the Forth code. I can simply use the assembler code to write a native word into the kernel (since the kernel is 64 bit assembly language) to perform the functionality of the algorithm.</p>\n",
            "Tag": "rsa,pgp,dsa,forth",
            "Answer": NaN,
            "combined_token_ids": "59381#, 1504#, 58065#, 4936090#, 20365#, 58632#, 256297#, 928356#, 59381, 61149, 58065, 256297"
        }
    ],
    [
        {
            "Id": 20661970,
            "CreationDate": "2013-12-18T15:23:19Z",
            "Score": 0,
            "Title": "Nested IIF statement in SSRS",
            "Body": "<p>I am having a problem with a simple nested IIF statement on SSRS. I am trying to do the second part where if the number is a <code>\"-\"</code> then it should return a <code>\"-\"</code>.</p>\n\n<p><code>=IIF(Fields!fbrt_number.Value &lt; \"0\",Fields!fbrt_number.Value, \"+\")</code></p>\n\n<p>Thanks</p>\n",
            "Tag": "reporting-services,ssrs-2008",
            "Answer": "<p>It's unclear what you're exactly after. I'm assuming you want to prefix all numbers (including positive numbers and zero) with a sign.</p>\n\n<p>Here's what your code currently does:</p>\n\n<ul>\n<li>Compares <code>fbrt_number</code>'s value with the <em>string</em> \"0\"</li>\n<li>Depending on the result either show the fields' value, or a plus sign</li>\n</ul>\n\n<p>Are you perhaps after this:</p>\n\n<pre><code>=IIF(Fields!fbrt_number.Value &lt; 0, \n     \"-\" + Fields!fbrt_number.Value.ToString(),\n     \"+\" + Fields!fbrt_number.Value.ToString())\n</code></pre>\n\n<p>This will compare the field value to the number 0, and depending on the result prefix a \"-\" or a \"+\".</p>\n\n<p>Or, if you want to display just a \"+\" for positive values, and a \"-\" for negatives:</p>\n\n<pre><code>=IIF(Fields!fbrt_number.Value &lt; 0, \n     \"-\",\n     \"+\")\n</code></pre>\n\n<p>Finally, if you want an empty string for 0 then this will work:</p>\n\n<pre><code>=IIF(Fields!fbrt_number.Value &lt; 0, \n     \"-\",\n     IIF(Fields!fbrt_number.Value &gt; 0, \"+\", \"\"))\n</code></pre>\n\n<p>Note that if your field isn't actually a number yet you may need to cast it first (either in your dataset query, or using SSRS expressions).</p>\n",
            "combined_token_ids": "414679#, 58065#, 1365849#, 20365#, 142687#, 9996237, 808690"
        }
    ],
    [
        {
            "Id": 20795400,
            "CreationDate": "2013-12-27T05:38:02Z",
            "Score": 0,
            "Title": "IIF to CASE WHEN statement",
            "Body": "<p>Good day.. Im having a hard time in converting from ms access sql to sql server 2005 sql query.. and here's my code : </p>\n\n<pre><code>UPDATE Data SET \n  Data.Mean =([std1]+[std2]+[std3]/\nIIf((3+(([std1]=0)+([std2]=0)+([std3]=0)))&gt;0,\n  (3+(([std1]=0)+([std2]=0)+([std3]=0))),1) \nWHERE Data.ID=125\n</code></pre>\n\n<p>I think the best way to convert this is by using <strong>CASE WHEN STATEMENT</strong> or any suggestions/alternatives you already know? </p>\n\n<p>Thank you in advance! </p>\n",
            "Tag": "sql,sql-server,vb.net,case-when,iif",
            "Answer": "<pre><code>UPDATE Data SET\nData.Mean =([std1]+[std2]+[std3]/\n(CASE WHEN (3+(([std1]=0)+([std2]=0)+([std3]=0)))&gt;0 \nTHEN (3+(([std1]=0)+([std2]=0)+([std3]=0)))\nELSE 1\nEND))\nWHERE Data.ID=125\n</code></pre>\n,,,,,<p>Try this</p>\n\n<pre><code>    UPDATE Data SET \n     Mean =([std1]+[std2]+[std3])/\n    case when abs([std1])+abs([std2])+abs([std3])=0 then 1 else \n      3 + case [std1] when 0 then -1 else 0 end \n        + case [std2] when 0 then -1 else 0 end \n        + case [std3] when 0 then -1 else 0 end\n    end\n    WHERE ID=125\n</code></pre>\n",
            "combined_token_ids": "58065#, 21183#, 129620#, 133114#, 1365849#, 62181, 1804314, 389887, 1258344, 58065"
        }
    ],
    [
        {
            "Id": 20805340,
            "CreationDate": "2013-12-27T17:48:47Z",
            "Score": 1,
            "Title": "Multiple Conditions for COUNT IIF",
            "Body": "<p>I am trying to get 2 count columns in an access query I have setup.</p>\n\n<p>I have a count of all employees fitting the criteria, now I need to get a count for 2 different job groups. The codes are for Supervisor Level 1 which is the code 11 and Supervisor Level 5 which is 72-79. I have tried a couple variations of the count IIF and it is not working, are there any thoughts or suggestions?</p>\n\n<pre><code>SELECT O896IA_VEMPPRSA.REG_NR, \n  O896IA_VEMPPRSA.DIS_NR, \n  Count(O896IA_VEMPPRSA.SYS_EMP_ID_NR) AS CountOfSYS_EMP_ID_NR\nFROM ((O896IA_VEMPPRSA  \n  INNER JOIN O867IA_VJOBHST  \n  ON O896IA_VEMPPRSA.SYS_EMP_ID_NR = O867IA_VJOBHST.SYS_EMP_ID_NR)  \n  INNER JOIN O867IA_VPJOBCO  \n  ON O896IA_VEMPPRSA.JOB_CLS_CD = O867IA_VPJOBCO.JOB_CLS_CD)  \n  INNER JOIN O867IA_VPJOBCO AS O867IA_VPJOBCO_1  \n  ON O867IA_VJOBHST.JOB_CLS_CD = O867IA_VPJOBCO_1.JOB_CLS_CD\nWHERE (((O867IA_VJOBHST.REC_EFF_STT_DT)&gt;=#7/1/2012#  \n  Or (O867IA_VJOBHST.REC_EFF_STT_DT)&gt;=#1/1/2012#)  \n  AND ((O896IA_VEMPPRSA.EMP_EMT_STS_CD)&lt;&gt;\"T\")  \n  AND ((O867IA_VJOBHST.EMP_ACN_TYP_CD)=\"HIR\")  \n  AND ((O867IA_VPJOBCO_1.JOB_GRP_CD) In (\"11\",\"72\",\"74\",\"77\",\"79\")))  \n  OR (((O867IA_VJOBHST.REC_EFF_STT_DT)&gt;=#7/1/2012#  \n  Or (O867IA_VJOBHST.REC_EFF_STT_DT)&gt;=#1/1/2012#)  \n  AND ((O896IA_VEMPPRSA.EMP_EMT_STS_CD)&lt;&gt;\"T\")  \n  AND ((O867IA_VJOBHST.EMP_ACN_TYP_CD)=\"PRO\")  \n  AND ((O867IA_VPJOBCO_1.JOB_GRP_CD) In (\"11\",\"72\",\"74\",\"77\",\"79\")))\nGROUP BY O896IA_VEMPPRSA.REG_NR, O896IA_VEMPPRSA.DIS_NR;\n</code></pre>\n",
            "Tag": "ms-access",
            "Answer": "<p>I think the code field you're talking about is <code>JOB_GRP_CD</code>, which appears to be text datatype.</p>\n\n<p>If that is correct, you can use <code>Sum</code> <code>IIf</code> instead of the <code>Count</code> <code>IIf</code> strategy you mentioned by adding two field expressions to the <code>SELECT</code> clause.</p>\n\n\n\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT\n    O896IA_VEMPPRSA.REG_NR,\n    O896IA_VEMPPRSA.DIS_NR,\n    Count(O896IA_VEMPPRSA.SYS_EMP_ID_NR) AS CountOfSYS_EMP_ID_NR,\n    Sum(IIf(O867IA_VPJOBCO_1.JOB_GRP_CD = '11', 1, 0))\n        AS [Supervisor Level 1],\n    Sum(IIf(O867IA_VPJOBCO_1.JOB_GRP_CD IN ('72','74','77','79'), 1, 0))\n        AS [Supervisor Level 5]\n</code></pre>\n\n<p>But if you prefer <code>Count</code> <code>IIf</code>, that could also work.</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>Count(IIf(O867IA_VPJOBCO_1.JOB_GRP_CD = '11', 1, Null))\n</code></pre>\n\n<p>If I guessed wrong about the field name and/or datatype, adapt one of these patterns with a condition which fits the correct field and datatype.</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>Sum(IIf(&lt;condition is True&gt;, 1, 0))\nCount(IIf(&lt;condition is True&gt;, 1, Null))\n</code></pre>\n",
            "combined_token_ids": "966092#, 1871932#, 62265#, 262813#, 58065#, 1287922"
        }
    ],
    [
        {
            "Id": 21119670,
            "CreationDate": "2014-01-14T17:14:35Z",
            "Score": 0,
            "Title": "Creating INNER Joins with IIF",
            "Body": "<p>I am trying to join three tables using and inner join and have the contents of one change colour if an e-mail has been sent.  </p>\n\n<p>Below is my query</p>\n\n<pre><code>SELECT IIF(COUNT Holdsent.job)&gt;0, #STD, #RED) AS Colour, jobs.job, jobs.jobstatus, jobs.client, jobs.logdate\nFROM jobs INNER JOIN clients ON clients.client = jobs.client INNER JOIN holdsent ON holdsent.job = jobs.job\nWHERE (jobs.jobstatus = 'HOLD' OR jobs.jobstatus = 'CLIHOLD')\n</code></pre>\n\n<p>Below is the error I receive</p>\n\n<blockquote>\n  <p>Expected lexical element not found: (missing ( in aggregate function\n  [Parsing Expression (column1 in the SELECT clause)] -- Location of\n  error in the SQL statement is:1 SELECT IIF(COUNT\n  Holdsent.job)>0,#STD, #RED) AS COLOUR,jobs.job,\n  jobs.jobstatus,jobs.client,jobs.logdate FROM jobs INNER JOIN clients\n  ON clients.client = jobs.client INNER JOIN holdsent ON holdsent.job =\n  jobs.job  WHERE (jobs.jobstatus = 'HOLD' OR jobs.jobstatus =\n  'CLIHOLD')</p>\n</blockquote>\n\n<p>I am new to SQL and can do basic queries, but am not clear on IIF.   Thank you in advance for any help you can provide.</p>\n",
            "Tag": "sql,sql-server",
            "Answer": "<p><code>iif</code> is a special function from MS Access, which SQL Server has started supporting with the most recent version.  The correct SQL form is the <code>case</code> statement.  An improved version of your query, written in standard SQL, is:</p>\n\n<pre><code>SELECT (case when COUNT(hs.job)&gt;0 then #STD else #RED end) AS Colour,\n       j.job, j.jobstatus, j.client, j.logdate\nFROM jobs j INNER JOIN\n     clients c\n     ON c.client = j.client INNER JOIN\n     holdsent hs\n     ON hs.job = j.job\nWHERE j.jobstatus in ('HOLD', 'CLIHOLD')\n</code></pre>\n,,,,,<p>Sorry, I didnt mock up test tables for this, but I think you want to subquery against your <code>holdsent</code> table to get the count value into the main query, then use three parameters in your <a href=\"http://technet.microsoft.com/en-us/library/hh213574.aspx\" rel=\"nofollow\">IIF() function</a>.  I didnt make a test case, but I think this will suit your needs:</p>\n\n<pre><code>SELECT      IIF((isnull(holdsentCount.jobCount,0)&gt;0, #STD, #RED) AS Colour\n            , jobs.job\n            , jobs.jobstatus\n            , jobs.client\n            , jobs.logdate\nFROM        jobs \nJOIN        clients \nON          clients.client = jobs.client \nLEFT JOIN   (select     holdsent.job\n                        , count(*) as jobCount \n            from        holdsent \n            group by    holdsent.job ) as holdsentCount\nON          holdsentCount.job = jobs.job\nWHERE       (jobs.jobstatus = 'HOLD' OR jobs.jobstatus = 'CLIHOLD')\n</code></pre>\n\n<p>Also, wrap the <code>holdsentCount.jobCount</code> with isnull() so that it returns 0 if it isn't returned in the subquery.</p>\n\n<p>EDIT: I dont know what '#STD' or '#RED' are so I left them as-is.</p>\n",
            "combined_token_ids": "948701#, 253035#, 257537#, 135976#, 58065#, 62181, 1804314"
        }
    ],
    [
        {
            "Id": 21492540,
            "CreationDate": "2014-02-01T00:25:41Z",
            "Score": 4,
            "Title": "DSA signature verification in C do not match with signature verification in console. OpenSSL (solved)",
            "Body": "<p>I wrote a code to sign a message that apparently works fine, it can sign a message with a DSA private key (512 bits), and verify it later with the respective public key (no problems here). Im using Windows 7.</p>\n\n<p>But, </p>\n\n<p>If i want to verify the sign in the console, openssl command always returns: Verification Failure.</p>\n\n<p>Some ideas?\nThank you.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;openssl\\dsa.h&gt;\n#include &lt;openssl\\engine.h&gt;\n#include &lt;openssl\\pem.h&gt;\n\nint main(){\n    char privkey[] = {\n        \"-----BEGIN DSA PRIVATE KEY-----\\n\"\n        \"MIH4AgEAAkEA3F41fxvcwGZeFxXg2v0/5SR+cxTizT25QugwZgrC7u2zQYTO1Qu0\\n\"\n        \"PPDKUrLxkaLzKsUEJbQ1DImnG/FxtRjH7QIVAOp+o1qPhOI4DtnvYS86ynTxhDcF\\n\"\n        \"AkAyKbiUxJigARuuVVlGn4emXOtrT+Al+gmKbbVFfkS62RhSZexQ9+mBLv0/1R8T\\n\"\n        \"k37AwuybnflijiPjLxB1ZL00AkA2DXjw+0PJOyrQfn2Q44uHyZMG2WfXqT7CIz26\\n\"\n        \"ZiIAHDOkZQhOvPLqCKAXfwHgGrgl2JLovhVY8nPMdNk2vJijAhUAzK9TuVobhOE8\\n\"\n        \"kU0xl8lqaI/PMyg=\\n\"\n        \"-----END DSA PRIVATE KEY-----\"\n        };\n\n    char pubkey[] = {\n        \"-----BEGIN PUBLIC KEY-----\\n\"\n        \"MIHwMIGoBgcqhkjOOAQBMIGcAkEA3F41fxvcwGZeFxXg2v0/5SR+cxTizT25Qugw\\n\"\n        \"ZgrC7u2zQYTO1Qu0PPDKUrLxkaLzKsUEJbQ1DImnG/FxtRjH7QIVAOp+o1qPhOI4\\n\"\n        \"DtnvYS86ynTxhDcFAkAyKbiUxJigARuuVVlGn4emXOtrT+Al+gmKbbVFfkS62RhS\\n\"\n        \"ZexQ9+mBLv0/1R8Tk37AwuybnflijiPjLxB1ZL00A0MAAkA2DXjw+0PJOyrQfn2Q\\n\"\n        \"44uHyZMG2WfXqT7CIz26ZiIAHDOkZQhOvPLqCKAXfwHgGrgl2JLovhVY8nPMdNk2\\n\"\n        \"vJij\\n\"\n        \"-----END PUBLIC KEY-----\"\n        };\n\n    char message[] = {\"Hello World!\"};\n\n    //save message for console test\n    FILE *message_file = fopen (\"message.txt\",\"w\");\n    fwrite(message, strlen(message), 1, message_file);\n    fclose(message_file);\n\n    //save private key for console test\n    FILE *privkey_file = fopen (\"privkey.pem\",\"w\");\n    fwrite(privkey, strlen(privkey), 1, privkey_file);\n    fclose(privkey_file);\n\n    //save public key for console test\n    FILE *pubkey_file = fopen (\"pubkey.pem\",\"w\");\n    fwrite(pubkey, strlen(pubkey), 1, pubkey_file);\n    fclose(pubkey_file);\n\n    //Prepare sign  -----------------------------------------------------\n\n    BIO *priv_bio;\n    priv_bio = BIO_new_mem_buf(privkey, -1); \n    if(priv_bio == NULL){ERR_print_errors_fp(stdout);return 1;}\n\n    DSA *private_key;\n    private_key = PEM_read_bio_DSAPrivateKey(priv_bio, NULL, NULL, NULL); \n    if(private_key == NULL){ERR_print_errors_fp(stdout);return 2;} \n\n    unsigned int result, sign_length;\n    unsigned char signature[1000] = {0};\n\n    //generate sign\n    result = DSA_sign(NULL, (const unsigned char*)message, strlen(message),\n                    (unsigned char*)signature, &amp;sign_length, private_key);\n\n    if(result!=1){ERR_print_errors_fp(stdout);return 3;}\n\n    //save signature for console test\n    FILE *sign_file = fopen (\"signature\",\"wb\");\n    fwrite((void*)signature, sign_length, 1, sign_file);\n    fclose(sign_file);\n\n    //verify sign  -----------------------------------------------------\n\n    BIO *pub_bio;\n    pub_bio = BIO_new_mem_buf(pubkey, -1); \n    if(pub_bio == NULL){ERR_print_errors_fp(stdout);return 4;} \n\n    DSA *public_key;\n    public_key = PEM_read_bio_DSA_PUBKEY(pub_bio, NULL, NULL, NULL);\n    if(public_key == NULL){ERR_print_errors_fp(stdout);return 5;} \n\n    result = DSA_verify(NULL, (const unsigned char*)message, strlen(message),\n                        signature, sign_length, public_key);\n\n    if(result&gt;0){\n        printf(\"Verification OK\\n\");\n    }else{\n        printf(\"Verification Failure. Error = %i\\n\",result);\n    }\n\n    BIO_free_all(priv_bio);\n    DSA_free(private_key);\n    DSA_free(public_key);\n\n    //Console verification\n    system(\"openssl dgst -verify pubkey.pem -signature signature message.txt\");\n\n    return 0;\n}\n</code></pre>\n\n<p>Output: </p>\n\n<pre><code>Verification OK\nVerification Failure\n</code></pre>\n\n<h1>Solved:</h1>\n\n<p>Apply SHA1 to the digest (message) before DSA_sign, <strong>and</strong>\napply SHA1 to the digest (message) before DSA_verify.</p>\n\n<p>This makes compatible the signature to work in console with OpenSSL.</p>\n",
            "Tag": "c,console,openssl,sign,dsa",
            "Answer": "<p>To use DSA with openssl you must pass in the <code>-dss1</code> to the dgst, otherwise it will use SHA1. Try this:</p>\n\n<pre><code>system(\"openssl dgst -dss1 -verify pubkey.pem -signature signature message.txt\");\n</code></pre>\n",
            "combined_token_ids": "58065#, 1366683#, 3098555#, 20365#, 3168#, 20175#, 63577#, 243410#, 135976#, 656312#, 673255#, 1280#, 3168, 656312, 673255, 133609, 58065"
        }
    ],
    [
        {
            "Id": 21538800,
            "CreationDate": "2014-02-03T22:04:13Z",
            "Score": 1,
            "Title": "Mdx Iif statment",
            "Body": "<p>I'm trying to get calculated measure while evaluating Pentaho Analyser.</p>\n\n<p><strong>Point:</strong> Need a measure with condition. My code: </p>\n\n<pre><code>IIf ([Product].CurrentMember Is [Product].[Food], [Unit Sales], 0)\n</code></pre>\n\n<p>So I get:</p>\n\n<p>Drinks  0</p>\n\n<p>Food    14</p>\n\n<p>Else    0</p>\n\n<p>End it works <strong>only until</strong> [Product] dimension is present on rows or columns.</p>\n\n<p>But when I insert another slicer, and remove [Product] ( [Partner] for example) I get:</p>\n\n<p>IBM   0</p>\n\n<p>MS    0</p>\n\n<p>Apple 0</p>\n\n<p><strong>Instead of:</strong></p>\n\n<p>IBM   7</p>\n\n<p>MS    2</p>\n\n<p>Apple 5</p>\n\n<p>I know, the main problem is <strong>CurrentMember</strong> property, and it's always zero because there is on CurrentMember on given dimension. Please, do not answer with: 'Filter it on \"Food\"'\nbecause I'm trying to build something more complex and this is a first step.</p>\n\n<p>Is there any trick to get this Measure work?</p>\n\n<p><strong>EDIT:</strong>\nI have 3 dimensions: Product, Partner, Country\nI need to get via mdx formula calculated measure:\n[Unit Sales] when it is [Product].[Food] and [Product].[Drink] and it NOT is [Country].[US] and [Country].[DE] but everything else.</p>\n\n<p>Thanks,\nBest Regards</p>\n",
            "Tag": "mdx,pentaho,data-warehouse,mondrian,iif",
            "Answer": "<p>I am not a specialist for Pentaho/Mondrian, but I would assume the issue is that in your second scenario, the <code>[Product].CurrentMember</code> is the all member of the products, not the <code>Food</code> member, and thus the system behaves as you told it, and returns 0.</p>\n\n<p>From how I understand your question, something like</p>\n\n<pre><code>IIf(\n    Count(\n        Intersect(\n            { [Product].CurrentMember },\n            { [Product].[Food], [Product].[Drink], [Product].[All] }\n        )\n    ) = 1\n    AND\n    Count(\n        Intersect(\n            { [Country].CurrentMember },\n            { [Country].[US], [Country].[DE], [Country].[All] }\n        )\n    ) = 0\n    [Unit Sales],\n    0\n   )\n</code></pre>\n\n<p>should deliver what you want. The trick here is that the intersection between the one-element set containing the <code>CurrentMember</code> and another set can either have one element - in case the <code>CurrentMember</code> is contained in the set -, or zero elements - in case the element is not contained in the set.</p>\n",
            "combined_token_ids": "62546#, 58065#, 980728#, 62546, 650449, 4794096, 948216, 58065"
        }
    ],
    [
        {
            "Id": 23564130,
            "CreationDate": "2014-05-09T12:00:45Z",
            "Score": 1,
            "Title": "Telerik textbox value expression IIF formatting",
            "Body": "<p>In Telerik Reporting, im using the condition for a textbox value expression</p>\n\n<p>=Iif(Parameters.UnitType.Value == \"some string\", some_value1, some_value2)</p>\n\n<p>And this is giving an error.\nnot valid:\nSyntax error: Missing operand before '=' operator</p>\n\n<p>Kindly let me know where i am going wrong.</p>\n\n<p>Regards,\nAnil</p>\n",
            "Tag": "telerik,telerik-reporting",
            "Answer": "<p>The problem lies interestingly in HOW the Iif works. It does not work like a C# if statement but more akin to a VB if statement. Thus the problem stems from the == itself. The Iif statement in telerik reports expects a single = instead of a == that is the reason why you get the error message when you use a == to compare the values.</p>\n\n<p>Thus if instead of:</p>\n\n<pre><code>=Iif(Parameters.UnitType.Value == \"some string\", some_value1, some_value2)\n</code></pre>\n\n<p>You use:</p>\n\n<pre><code>=Iif(Parameters.UnitType.Value = \"some string\", some_value1, some_value2)\n</code></pre>\n\n<p>The statement should work.</p>\n",
            "combined_token_ids": "650667#, 681728#, 249936#, 1883424#, 58065#, 425287#, 650667, 8511252"
        }
    ],
    [
        {
            "Id": 24127680,
            "CreationDate": "2014-06-09T19:39:29Z",
            "Score": 0,
            "Title": "IIF Function in Access query that adds three fields together and compares answer to another field",
            "Body": "<p>I'm using Windows Access 2010.  I'm trying to run an IIF Function, using Expression Builder, in a query on one table that asks the query to add three fields together and compare the answer to a fourth field.  If the sum of the three fields are equal to the fourth field return \"Ok\" if not equal return\"Err\".</p>\n\n<p>This is the the expression I'm using:</p>\n\n<pre><code>SalmonRelSum: IIf([SalmonRelUM]+[SalmonRelAd]+\n                  [SalmonRelUK]=SalmonReleasedCount],\"Ok\",\"Err\")\n</code></pre>\n\n<p>When I run the query I get Err on all lines whether it is correct or not.</p>\n\n<p>What am I doing wrong?</p>\n",
            "Tag": "sql,iif-function",
            "Answer": "<p>Assuming that you really mean this:</p>\n\n<pre><code>IIf([SalmonRelUM]+[SalmonRelAd]+[SalmonRelUK]=[SalmonReleasedCount],\"Ok\",\"Err\")\n--------------------------------^\n</code></pre>\n\n<p>The problem is probably <code>NULL</code> values.  You can use the <code>NZ()</code> function to treat them as zeroes:</p>\n\n<pre><code>IIf(NZ([SalmonRelUM], 0) + NZ([SalmonRelAd], 0) + NZ([SalmonRelUK], 0) =[SalmonReleasedCount], \n    \"Ok\", \"Err\"\n   )\n</code></pre>\n",
            "combined_token_ids": "58065#, 975262#, 20365#, 421172#, 265771#, 134229#, 55818#, 244661#, 240301#, 961618#, 57688#, 645667#, 433478#, 21183#, 659999#, 62181, 3055347"
        }
    ],
    [
        {
            "Id": 24662280,
            "CreationDate": "2014-07-09T19:30:38Z",
            "Score": 0,
            "Title": "#Error in a greater than iif sum statement",
            "Body": "<p>I'm trying to write some code that will prevent a #Error.</p>\n\n<p>I don't know where my issue is.  </p>\n\n<pre><code>=Sum(IIF(Fields!CurrentNumDaysOD.Value &gt;= 1 And Fields!CurrentNumDaysOD.Value &lt;= 10,\nFields!CurrentBalance.Value, \"0\")) / Sum(IIF(Fields!CurrentNumDaysOD.Value &gt; 0, \nFields!CurrentBalance.Value, \"0\"))\n</code></pre>\n\n<p>I have also attempted this:</p>\n\n<pre><code>=Sum(IIF(Fields!CurrentNumDaysOD.Value &gt;= 1 And Fields!CurrentNumDaysOD.Value &lt;= 10,\n Fields!CurrentBalance.Value, Nothing)) / Sum(IIF(Fields!CurrentNumDaysOD.Value &gt; 0,\n Fields!CurrentBalance.Value, Nothing))\n</code></pre>\n",
            "Tag": "reporting-services,ssrs-2008-r2",
            "Answer": "<p>If the result of the second half of your statement (after the <code>/</code>) is 0, then you will be dividing by 0, which will cause an error.</p>\n",
            "combined_token_ids": "1120#, 20365#, 3104#, 248841#, 131247#, 58065#, 63209#, 1365849#, 9996237, 1935315"
        }
    ],
    [
        {
            "Id": 24664420,
            "CreationDate": "2014-07-09T21:55:58Z",
            "Score": 0,
            "Title": "SSRS Count Distinct with iif filter",
            "Body": "<p>So this is a pretty complex one.  I am trying to put a filter on a count distinct in SSRS.  Here is the situation.</p>\n\n<p>I have 3 datasets in the report.  All 3 datasets have the same fields but are built on different code.</p>\n\n<p>I want to count the distinct hospitals in one of the datasets while applying a filter to one of the fields.</p>\n\n<p>For example I want to Count distinct Hospital codes when the DatePeriod is between 3 months ago and today.  Here is what I have.</p>\n\n<pre><code>=iif((Fields!DatePeriod.Value, \"Rpt_WinBack\") between DateAdd(\"m\",-3,Today()) and DateAdd(\"m\",0,Today()), (CountDistinct(Fields!HospCode.Value, \"Rpt_WinBack\") &amp; \" Hospitals\"),nothing)\n</code></pre>\n\n<p>I currently get an error that states:</p>\n\n<p>\"Textbox4 refers directly to the field 'DatePeriod' without specifying a dataset aggregate.  When the report contains multiple datasets, filed references outside of a data region must be contained within aggregate functions which specify a dataset scope.\"</p>\n\n<p>It is possible that a hospital will show up on multiple dates.</p>\n\n<p>Thanks,\nScott</p>\n",
            "Tag": "reporting-services,ssrs-2012",
            "Answer": "<p>Try this instead:</p>\n\n<pre><code>=CountDistinct(iif((Fields!DatePeriod.Value, \"Rpt_WinBack\") between DateAdd(\"m\",-3,Today()) and DateAdd(\"m\",0,Today()), (Fields!HospCode.Value, \"Rpt_WinBack\"),nothing )) &amp; \" Hospitals\"\n</code></pre>\n",
            "combined_token_ids": "142687#, 262813#, 974266#, 135976#, 58065#, 426400#, 9996237, 795851"
        }
    ],
    [
        {
            "Id": 25462130,
            "CreationDate": "2014-08-23T12:53:45Z",
            "Score": 1,
            "Title": "IIf statement too complex",
            "Body": "<p>I am attempting quite a long IIf statement in MS Access 2003, but when I bolt bits on it's advising me its too complex:</p>\n\n<pre><code>MIN_PASS_FAIL: IIf(\n  [MIN CAR RESPONSE CODE] = \"0033\"\n, \"ACCEPTED\"\n, IIf(\n    [MIN CAR RESPONSE CODE] = \"0037\"\n  , \"ACCEPTED\"\n  , IIf(\n      [MIN CAR RESPONSE CODE] = \"0038\"\n    , \"ACCEPTED\"\n    , IIf(\n        [MIN CAR RESPONSE CODE] = \"0039\"\n      , \"ACCEPTED\"\n      , IIf(\n          [MIN CAR RESPONSE CODE] = \"0040\"\n        , \"ACCEPTED\"\n        , IIf(\n            [MIN CAR RESPONSE CODE] = \"0055\"\n          , \"ACCEPTED\"\n          , IIf(\n              [MIN CAR RESPONSE CODE] = \"0056\"\n            , \"ACCEPTED\"\n            , IIf(\n                [MIN CAR RESPONSE CODE] = \"0061\"\n              , \"ACCEPTED\"\n              , IIf(\n                  [MIN CAR RESPONSE CODE] = \"0073\"\n                , \"ACCEPTED\"\n                , Iif(\n                    [MIN CAR RESPONSE CODE] = \"0013\"\n                  , \"INFORMATION\"\n                  , Iif(\n                      [MIN CAR RESPONSE CODE] = \"0018\"\n                    , \"INFORMATION\"\n                    , Iif(\n                        [MIN CAR RESPONSE CODE] = \"0019\"\n                      , \"INFORMATION\"\n                      , Iif(\n                          [MIN CAR RESPONSE CODE] = \"0028\"\n                        , \"INFORMATION\"\n                        , Iif(\n                            [MIN CAR RESPONSE CODE] = \"0045\"\n                          , \"INFORMATION\"\n                          , Iif(\n                              [MIN CAR RESPONSE CODE] = \"0046\"\n                            , \"INFORMATION\"\n                            , Iif(\n                                [MIN CAR RESPONSE CODE] = \"0047\"\n                              , \"INFORMATION\"\n                              , Iif(\n                                  [MIN CAR RESPONSE CODE] = \"0048\"\n                                , \"INFORMATION\"\n                                , Iif(\n                                    [MIN CAR RESPONSE CODE] = \"0060\"\n                                  , \"INFORMATION\"\n                                  , \"REJECTED\"\n                                  )\n                                )\n                              )\n                            )\n                          )\n                        )\n                      )\n                    )\n                  )\n                )\n              )\n            )\n          )\n        )\n      )\n    )\n  )\n)\n</code></pre>\n\n<p>I want three outputs, \"Accepted\" \"Rejected\" and \"Information\"..</p>\n\n<p>How would I be able to resolve this?</p>\n",
            "Tag": "ms-access,if-statement,ms-access-2003",
            "Answer": "<p>You have one set of codes which map to <em>\"ACCEPTED\"</em>, and another set which maps to <em>\"INFORMATION\"</em>.  Any other code should map to <em>\"REJECTED\"</em>.</p>\n\n<p>Use a table such as the one below to store the mappings for the first two sets.  You can then use <code>DLookup</code> to retrieve <em>response_text</em> values for codes in the first 2 sets.  </p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>DLookup(\"response_text\", \"YourTableNameHere\", \"response_code='\" &amp; [MIN CAR RESPONSE CODE] &amp; \"'\")\n</code></pre>\n\n<p>For <em>\"REJECTED\"</em> codes, <code>DLookup</code> will return Null.  So you can use <code>Nz()</code> to substitute <em>\"REJECTED\"</em> for Null.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Nz(DLookup(\"response_text\", \"YourTableNameHere\", \"response_code='\" &amp; [MIN CAR RESPONSE CODE] &amp; \"'\"), \"REJECTED\")\n</code></pre>\n\n<p>A similar approach should work in Access VBA code or in a query run from within an Access session.  If you will be using this in a query which will be run outside an Access session, you can use an <code>IIf</code> expression instead of <code>Nz</code>.</p>\n\n<p>However, if this is for a query, consider left joining your main data table to the mapping table.  Then you wouldn't even need <code>DLookup</code>...</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT\n    main.[MIN CAR RESPONSE CODE],\n    Nz(ytnh.response_text, 'REJECTED') AS MIN_PASS_FAIL\nFROM\n    MainTable AS main\n    LEFT JOIN YourTableNameHere AS ytnh\n    ON main.[MIN CAR RESPONSE CODE] = ytnh.response_code;\n</code></pre>\n\n<p>The mapping table ...</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>response_code response_text\n0033          ACCEPTED\n0037          ACCEPTED\n0038          ACCEPTED\n0039          ACCEPTED\n0040          ACCEPTED\n0055          ACCEPTED\n0056          ACCEPTED\n0061          ACCEPTED\n0073          ACCEPTED\n0013          INFORMATION\n0018          INFORMATION\n0019          INFORMATION\n0028          INFORMATION\n0045          INFORMATION\n0046          INFORMATION\n0047          INFORMATION\n0048          INFORMATION\n0060          INFORMATION\n</code></pre>\n,,,,,<p>HansUp's answer to put it into lookup tables is good. Especially if they may change. For an answer that doesn't require lookup tables, you can use the InStr function. try this:</p>\n\n<pre><code>MIN_PASS_FAIL: IIF(InStr(\"0033.0037.0038.0039.0040.0055.0056\",[MIN CAR RESPONSE CODE]),\"ACCEPTED\",IIf(InStr(\"0013.0018.0019.0028.0045.0046.0047.0048.0060\",[MIN CAR RESPONSE CODE]),\"ACCEPTED\",IIf(InStr(\"0013.0018.0019.0028.0045.0046.0047.0048.0060\",[MIN CAR RESPONSE CODE]),\"INFORMATION\",\"REJECTED\")))\n</code></pre>\n,,,,,<p>HansUp's answer is definitely the best one since you have so many items to look up. I'll point out an alternative because it might be handy in other situations.</p>\n\n<p>Since you're always testing the same field, you can use the SQL <code>in</code> operator:</p>\n\n<pre><code>MIN_PASS_FAIL: IIf(\n  [MIN CAR RESPONSE CODE] in (\n    \"0033\"\n  , \"0037\"\n  , \"0038\"\n  , ...\n  )\n, \"ACCEPTED\"\n, Iif(\n    [MIN CAR RESPONSE CODE] in (\n      \"0013\"\n    , \"0018\"\n    , \"0019\"\n    , ...\n    )\n  , \"INFORMATION\"\n  , \"REJECTED\"\n  )\n)\n</code></pre>\n\n<p>The <code>in</code> operator tests if the value is one out of a list of values. This keeps your code relatively flat. In fact, you can flatten it completely by using the <code>Switch</code> function instead of the <code>Iif</code> function:</p>\n\n<pre><code>MIN_PASS_FAIL: Switch(\n  [MIN CAR RESPONSE CODE] in (\n    \"0033\"\n  , \"0037\"\n  , \"0038\"\n  , ...\n  )\n, \"ACCEPTED\"\n, [MIN CAR RESPONSE CODE] in (\n    \"0013\"\n  , \"0018\"\n  , \"0019\"\n  , ...\n  )\n, \"INFORMATION\"\n, True\n, \"REJECTED\"\n)\n</code></pre>\n\n<p>You can look up details on the <code>Switch</code> function easily enough, but basically it works like a <code>case</code> statement or <code>switch</code> statement in other languages, but SQL is conveniently expression-oriented so you're always returning a value.</p>\n,,,,,<p>I would write a function in visual basic and then call it from the query. Much faster than a table lookup.\nMIN_PASS_FAIL: GetResponseStatus([MIN CAR RESPONSE CODE])</p>\n",
            "combined_token_ids": "58065#, 1365849#, 62741#, 669554#, 1287922, 3081021, 3267855"
        }
    ],
    [
        {
            "Id": 25597680,
            "CreationDate": "2014-09-01T01:02:51Z",
            "Score": 0,
            "Title": "Access 2002/VBA - IIf",
            "Body": "<p>Consider:</p>\n\n<pre><code>sqlAddress = \"SELECT \" _\n&amp; \"address_line_1, address_line_2, city, postcode, state \" _\n&amp; \"FROM contacts \" _\n&amp; \"WHERE (contact_id =\" &amp; contact_id &amp; \")\"\n\nSet rsAddress = dbs.OpenRecordset(sqlAddress)\n\nIf Not rsAddress.EOF Then\n    addressStr = IIf(rsAddress(\"address_line_2\")='', rsAddress(\"address_line_1\") &amp; Chr(13) + Chr(10) &amp; rsAddress(\"city\") &amp; Chr(13) + Chr(10) &amp; rsAddress(\"postcode\") &amp; Chr(13) + Chr(10) &amp; rsAddress(\"state\"), rsAddress(\"address_line_1\") &amp; Chr(13) + Chr(10) &amp; rsAddress(\"address_line_2\") &amp; Chr(13) + Chr(10) &amp; rsAddress(\"city\") &amp; Chr(13) + Chr(10) &amp; rsAddress(\"postcode\") &amp; Chr(13) + Chr(10) &amp; rsAddress(\"state\"))\n    Me.vcTBAddress.SetFocus\n    Me.vcTBAddress = addressStr\nEnd If\n</code></pre>\n\n<p>What I want this to do is to ONLY display the address_line_2 in case it is not null and it is not an empty string.  The IIf is returning a syntax error.  I cannot see why - what am I missing please?</p>\n",
            "Tag": "vba,ms-access,syntax,access-vba",
            "Answer": "<p>The answer is, of course, that I have stuffed up the empty string test: \n<code>rsAddress(\"address_line_2\")=''</code>.  </p>\n\n<p>The correct syntax is: <code>rsAddress(\"address_line_2\")=\"\"</code> with double quotes <code>\"</code>, not single quotes <code>'</code>.  </p>\n",
            "combined_token_ids": "421172#, 718516#, 1440#, 58065#, 56578, 1287922, 438895, 1666304"
        }
    ],
    [
        {
            "Id": 25762310,
            "CreationDate": "2014-09-10T09:50:16Z",
            "Score": 0,
            "Title": "Reporting Services How to get the Count() value from IIF",
            "Body": "<p>I have this table with a column named Open_Time which contain a datetime value. I would like to have another column named Total Ticket In June with the total count of ticket in June, so I've inserted the expression like below:   </p>\n\n<p>=Count((IIF(DatePart(\"m\",Fields!Open_Time.Value,0,0) = \"6\",1,0)))</p>\n\n<p>but there seems to be an error. To make myself clear, the table should look like this:</p>\n\n<pre><code>Assigned Name    Ticket ID    Open_Time    Total Ticket in June\n\nIvan             001          3/28/2014            2\n                 002          6/24/2014\n                 003          6/11/2014\n</code></pre>\n\n<p>I would like to get value \"2\", which is the total number of ticket in June. Any idea? :) </p>\n",
            "Tag": "reporting-services",
            "Answer": "<p>Try this:\n=Count((IIF(DatePart(dateinterval.Month,Fields!Open_Time.Value,0,0) = 6,1,0)))</p>\n,,,,,<p>You need to switch to a <code>Sum</code> aggregate instead of <code>Count</code> (based on your <code>IIF</code>, <code>Count</code> will count every row instead of giving you a total number of occurences):</p>\n\n<pre><code>=Sum(IIF(DatePart(\"m\",Fields!Open_Time.Value,0,0) = 6, 1, 0))\n</code></pre>\n\n<p>From your table it's hard to tell your row groupings, but keep in mind that you'll only get the sum you expect if that expression is on a totals row (i.e. if you use that expression on the detail row it will simply list 1 or 0 for each date).</p>\n",
            "combined_token_ids": "1369202#, 962364#, 63853#, 21183#, 61049#, 58632#, 262813#, 249936#, 136712#, 58065#, 9996237"
        }
    ],
    [
        {
            "Id": 26187430,
            "CreationDate": "2014-10-03T22:03:59Z",
            "Score": 2,
            "Title": "How to load a DSA Key from KeyInfo using openSSL",
            "Body": "<p>I am trying to verify an XML digital signature using openSSL. When I actually use EVP_VerifyFinal, I get the error code 0D07209B (ASN1_get_object:too long). He's how I load the the KeyInfo from the cert:</p>\n\n<pre><code>&lt;KeyInfo&gt;\n &lt;KeyValue&gt;\n  &lt;DSAKeyValue&gt;\n    &lt;P&gt;/KaCzo4Syrom78z3EQ5SbbB4sF7ey80etKII864WF64B81uRpH5t9jQTxeEu0ImbzRMqzVDZkVG9xD7nN1kuFw==&lt;/P&gt;\n    &lt;Q&gt;li7dzDacuo67Jg7mtqEm2TRuOMU=&lt;/Q&gt;\n    &lt;G&gt;Z4Rxsnqc9E7pGknFFH2xqaryRPBaQ01khpMdLRQnG541Awtx/XPaF5Bpsy4pNWMOHCBiNU0NogpsQW5QvnlMpA==&lt;/G&gt;\n    &lt;Y&gt;butK4tBy8dwSJFjTRpTvmYZYnsDGO4CzMVgcD8EQ2UJrQZd0ZapQI/Ea2DZzQBTFjjdnNkFuNOtjVI615lhiBQ==&lt;/Y&gt;\n  &lt;/DSAKeyValue&gt;\n &lt;/KeyValue&gt;\n&lt;/KeyInfo&gt;\n</code></pre>\n\n<p>My (pseudocode) method for loading the PDSA:</p>\n\n<pre><code> pDSA = DSA_new();\n pDSA.p = BN_bin2bn(base64Decode(text of P element));\n pDSA.q = BN_bin2bn(base64Decode(text of Q element));\n pDSA.g = BN_bin2bn(base64Decode(text of G element));\n pDSA.pub_key = BN_bin2bn(base64Decode(text of Y element));\n</code></pre>\n\n<p>Using BN_bn2hex after this gives me the values:</p>\n\n<pre><code>p: FCA682CE8E12CABA26EFCCF7110E526DB078B05EDECBCD1EB4A208F3AE1617AE01F35B91A47E6DF63413C5E12ED0899BCD132ACD50D99151BDC43EE737592E17\nq: 962EDDCC369CBA8EBB260EE6B6A126D9346E38C5\ng: 678471B27A9CF44EE91A49C5147DB1A9AAF244F05A434D6486931D2D14271B9E35030B71FD73DA179069B32E2935630E1C2062354D0DA20A6C416E50BE794CA4\npub_key: 6EEB4AE2D072F1DC122458D34694EF9986589EC0C63B80B331581C0FC110D9426B41977465AA5023F11AD836734014C58E376736416E34EB63548EB5E6586205\n</code></pre>\n\n<p>the, validating the signature:</p>\n\n<pre><code>  &lt;Signature xmlns=\"http://www.w3.org/2000/09/xmldsig#\"&gt;\n    &lt;SignedInfo&gt;\n      &lt;CanonicalizationMethod Algorithm=\"http://www.w3.org/TR/2001/REC-xml-c14n-20010315\"/&gt;\n      &lt;SignatureMethod Algorithm=\"http://www.w3.org/2000/09/xmldsig#dsa-sha1\"/&gt;\n      &lt;Reference URI=\"\"&gt;\n        &lt;Transforms&gt;\n         &lt;Transform Algorithm=\"http://www.w3.org/2000/09/xmldsig#enveloped-signature\"/&gt;\n       &lt;/Transforms&gt;\n       &lt;DigestMethod Algorithm=\"http://www.w3.org/2000/09/xmldsig#sha1\"/&gt;      \n       &lt;DigestValue&gt;uooqbWYa5VCqcJCbuymBKqm17vY=&lt;/DigestValue&gt;\n      &lt;/Reference&gt;\n    &lt;/SignedInfo&gt;    \n    &lt;SignatureValue&gt;L4h4TFDj5rDKCHm0D+aH2LeSfAMV2t0V5S91Afu6U0NlfpjxdTXRUA==&lt;/SignatureValue&gt; \n    &lt;KeyInfo&gt;\n     &lt;KeyValue&gt;\n      &lt;DSAKeyValue&gt;         \n       &lt;P&gt;/KaCzo4Syrom78z3EQ5SbbB4sF7ey80etKII864WF64B81uRpH5t9jQTxeEu0ImbzRMqzVDZkVG9xD7nN1kuFw=&lt;/P&gt; \n       &lt;Q&gt;li7dzDacuo67Jg7mtqEm2TRuOMU=&lt;/Q&gt; \n       &lt;G&gt;Z4Rxsnqc9E7pGknFFH2xqaryRPBaQ01khpMdLRQnG541Awtx/XPaF5Bpsy4pNWMOHCBiNU0NogpsQW5QvnlMpA==&lt;/G&gt;\n       &lt;Y&gt;POKkQtGuazaz6OEWi91P4C9z1tREpeP9f7L3piRD/3TiNFzvt0BmYzNO0CoPSjEVTXYKIRo/+HXK6MhBRk2eUw=&lt;/Y&gt;\n     &lt;/DSAKeyValue&gt;\n    &lt;/KeyValue&gt;\n   &lt;/KeyInfo&gt;\n  &lt;/Signature&gt;\n&lt;/Envelope&gt;\n</code></pre>\n\n<p>Here's how I validate the signature:</p>\n\n<pre><code>  pkey = EVP_PKEY_new;\n  EVP_PKEY_set1_DSA(pkey, pdsa)\n  EVP_MD_CTX_init(ctx);\n  EVP_VerifyInit(@ctx, EVP_sha1)\n  EVP_VerifyUpdate(@ctx, digest of SignedInfo);\n  bytes = unbase64(text of SignatureValue)\n  EVP_VerifyFinal(@ctx, btes, length(bytes)}, pKey);\n</code></pre>\n\n<p>Verify final returns the following errors:</p>\n\n<pre><code>0D07207B:asn1 encoding routines:ASN1_get_object:header too long)\n0D068066:asn1 encoding routines:ASN1_CHECK_TLEN:bad object header)\n0D07803A:asn1 encoding routines:ASN1_ITEM_EX_D2I:nested asn1 error)\n</code></pre>\n\n<p>So either I am loading the certificate or the signature value wrongly. According the spec, the signature value is \"The signature value consists of the base64 encoding of the concatenation of two octet-streams that respectively result from the octet-encoding of the values r and s in that order\" - but I cannot find anywhere in the openSSL documentation what should be passed to EVP_VerifyInit for the signature value for a DSA signature. I found one reference in an email archive that pointed to RFC 3279 which appears to specify the same format, so far as I can tell (Dss-Sig-Value  ::=  SEQUENCE  { r       INTEGER, s       INTEGER  }</p>\n",
            "Tag": "openssl,digital-signature,dsa",
            "Answer": "<p>Yes, you've actually already answered your own question. You should split the received signature in two (two 20 byte values as specified by XML-DSig), and then create the ASN.1 signature. It would indeed consist of the following ASN.1 DER structure:</p>\n\n<pre><code>Dss-Sig-Value ::= SEQUENCE {\n    r INTEGER,\n    s INTEGER\n}\n</code></pre>\n\n<p>DER is a \"tag, length, value\" structure. Now a SEQUENCE has tag encoding <code>30</code>, then a DER length of the two <em>encoded</em> integers, and r and s are INTEGER values, encoded with tag <code>02</code> then the length followed by the <em>shortest representation of a signed big endian integer</em>.</p>\n\n<p>As programming ASN.1 is tricky at best and downright vulnerable as worst (all versions up to 1.0.1 of OpenSSL had a memory corruption bug, Windows NT authentication of old was completely broken) I'll show how to create this structure using pseudo code:</p>\n\n<ul>\n<li>convert the base64 to bytes (unsigned chars, forty of them)</li>\n<li>use the first 20 bytes for <code>rData</code>, the second for <code>sData</code> (or better, split in half)</li>\n<li>strip all leading (leftmost) <code>00</code> valued bytes of <code>rData</code> and <code>sData</code></li>\n<li>if the leading byte is <code>80</code> or over, prefix a <code>00</code> byte to <code>rData</code> an <code>sData</code></li>\n<li>create a structure <code>30 LL { 02 LL { rData } 02 LL { sData } }</code> where LL is the size in bytes of the structure between braces</li>\n</ul>\n\n<p>I'll leave it to you to perform the encoding. Note that this will work as long as <code>LL</code> is never the value of 128 or over (which should be the case for DSA).</p>\n\n<p>You may want to switch to ECDSA by the way; note that it would likely require the same structure above. Also note that I cannot see if the input of the digest is correct, but it should at least resolve the ASN.1 error.</p>\n\n<hr>\n\n<p>In the end you should get <a href=\"http://lapo.it/asn1js/#302C02142F88784C50E3E6B0CA0879B40FE687D8B7927C03021415DADD15E52F7501FBBA5343657E98F17535D150\" rel=\"nofollow\">this structure</a> for you current signature (note that this one is a bit boring as it doesn't contain any initial values of <code>00</code> and it does not contain any initial bytes equal to or higher than 128 either).  </p>\n",
            "combined_token_ids": "63853#, 21183#, 127020#, 3104#, 58065#, 62825#, 136712#, 658484#, 60783#, 673255#, 673255, 8452729, 58065"
        }
    ],
    [
        {
            "Id": 26320870,
            "CreationDate": "2014-10-12T01:11:45Z",
            "Score": 1,
            "Title": "Using summed field in query twice with IIF statement - have I missed some syntax somewhere?",
            "Body": "<p>Having a bit of a problem with my code and can't figure out where I'm going wrong.</p>\n\n<p>Essentially this query will return all employees for a given employer for a given year, along with the amount of their allowances, tax withheld, and gross payments they've received, and their Reportable Employer Superannuation Contributions (RESC).</p>\n\n<p>RESC is any amounts (tblSuperPayments.PaymentAmount) paid over and above the superannuation guarantee, which is gross payments (sum of tblPayment.GrossPayment) * super rate (tblSuperRate.SuperRate). Otherwise, RESC is 0.</p>\n\n<p>The data that I currently have in my tables is as follows</p>\n\n<pre><code>SUM(tblPayment.GrossPayment) = 1730\nSUM(tblEmployee.TaxPayable) = 80\nSUM(tblSuperPayments.PaymentAmount) = 500\ntblSuperRate.SuperRate = 9.5%\n</code></pre>\n\n<p>Therefore my query should be returning an amount of RESC of 500-(1730*9.5%)= 335.65.</p>\n\n<p>However, my query is currently returning $835.65 - meaning that (1730*9.5%) is returning -335.65.</p>\n\n<p>I can't figure out where my logic is going wrong - it's probably something simple but I can't see it. I suspect that it might be summing tblPayment.GrossPayment twice (edited on request)</p>\n\n<pre><code>SELECT \ntblEmployee.EmployeeID AS Id\nSUM(tblPayment.Allowances) AS TotAllow, \nSUM(tblPayment.TaxPayable) AS TotTax, \nSUM(tblPayment.GrossPayment) AS TotGross, \n(IIF \n((SUM(tblSuperPayments.PaymentAmount)) &lt;= (SUM(tblPayment.GrossPayment)*tblSuperRate.SuperRate),\n0,\n(SUM(tblSuperPayments.PaymentAmount) - (SUM(tblPayment.GrossPayment)*tblSuperRate.SuperRate))\n)) As TotRESC\nFROM \n((tblEmployee \nLEFT JOIN tblPayment  // any reason for using left join over inner join\nON tblEmployee.EmployeeID = tblPayment.fk_EmployeeID) \nLEFT JOIN tblSuperPayments  // any reason for using left join over inner join\nON tblEmployee.EmployeeID = tblSuperPayments.fk_EmployeeID) \nLEFT JOIN tblSuperRate  // any reason for using left join over inner join\nON (tblPayment.PaymentDate &lt;= tblSuperRate.TaxYearEnd) // these two conditions might be returning \nAND (tblPayment.PaymentDate &gt;= tblSuperRate.TaxYearStart) //two SuperRate rows because of using equals in both \nWHERE \ntblEmployee.fk_EmployerID = 1\nGROUP BY \ntblEmployee.EmployeeID,\ntblSuperRate.SuperRate; \n</code></pre>\n",
            "Tag": "sql,ms-access,sum,iif",
            "Answer": "<p>Looking at your query I recommend you to just <code>group by</code> primary key (<code>EmployeeID</code>) of <code>tblEmployee</code> and the use the result as a sub query and do a join later tham using many columns of <code>tblEmployee</code>in group by which might cause duplicate rows.  I rewrote the query as I have mentioned above and added comments at places which might cause the error.</p>\n\n<pre><code>SELECT \ntblEmployee.TFN, \ntblEmployee.FirstName, \ntblEmployee.MiddleName, \ntblEmployee.LastName, \ntblEmployee.DOB, \ntblEmployee.MailingAddress, \ntblEmployee.AddressLine2, \ntblEmployee.City, \ntblEmployee.fk_StateProvinceID, \ntblEmployee.PostalCode, \ntemp.TotAllow, \ntemp.TotTax, \ntemp.TotGross, \ntemp.TotRESC\nFROM\n(SELECT \ntblEmployee.EmployeeID AS Id\nSUM(tblPayment.Allowances) AS TotAllow, \nSUM(tblPayment.TaxPayable) AS TotTax, \nSUM(tblPayment.GrossPayment) AS TotGross, \n(IIF \n((SUM(tblSuperPayments.PaymentAmount)) &lt;= (SUM(tblPayment.GrossPayment)*tblSuperRate.SuperRate),\n0,\n(SUM(tblSuperPayments.PaymentAmount) - (SUM(tblPayment.GrossPayment)*tblSuperRate.SuperRate))\n)) As TotRESC\nFROM \n((tblEmployee \nLEFT JOIN tblPayment  // any reason for using left join over inner join\nON tblEmployee.EmployeeID = tblPayment.fk_EmployeeID) \nLEFT JOIN tblSuperPayments  // any reason for using left join over inner join\nON tblEmployee.EmployeeID = tblSuperPayments.fk_EmployeeID) \nLEFT JOIN tblSuperRate  // any reason for using left join over inner join\nON (tblPayment.PaymentDate &lt;= tblSuperRate.TaxYearEnd) // these two conditions might be returning \nAND (tblPayment.PaymentDate &gt;= tblSuperRate.TaxYearStart) //two SuperRate rows because of using equals in both \nWHERE \ntblEmployee.fk_EmployerID = 1\nGROUP BY \ntblEmployee.EmployeeID,\ntblSuperRate.SuperRate) temp // Does a single employee have more than one superrate why grouping by it?\nJOIN tblEmployee ON tblEmployee.EmployeeID=temp.Id; \n</code></pre>\n",
            "combined_token_ids": "251185#, 63209#, 240301#, 20365#, 265771#, 243890#, 135976#, 58065#, 1365849#, 1440#, 131364#, 3360#, 139820#, 132868#, 438895#, 1344360#, 62181, 1287922, 63209, 58065"
        }
    ],
    [
        {
            "Id": 26387540,
            "CreationDate": "2014-10-15T16:30:27Z",
            "Score": 1,
            "Title": "using IIF function one parameter / field to be displayed basis combination of Multiple fields",
            "Body": "<p>I need a help on MS Access. Below are 3 tables to be used.</p>\n\n<p>Logic:</p>\n\n<p>I need a query which should fetch VATRATE available in <code>VAT_Inclusion</code> basis combination of GL, branch and domicile (in same table). Example:</p>\n\n<pre><code>VAT_Inclusion\n\nBranch|Local_GL_Start|Local_GL_end|Domicile|VATRATE\n------+--------------+------------+--------+-------\n 21   |40000         |50000       |UK      |9\n</code></pre>\n\n<p>Details of domicile: to be fetched basis local customer id from <code>GRT</code> table and local customer id in <code>Domicile</code> table. <code>GRT</code> does not contain domicile but <code>Domicile</code> does.</p>\n\n<p>For your reference I have prepared a query (given below at the end) but facing some issues.</p>\n\n<p>Output in <code>GRT</code> table format:</p>\n\n<pre><code>Branch|Local_GL| Local_CUST_ID|VAT RATE\n------+--------+--------------+--------\n21    | 40010  |  CUST_223    |9 \n</code></pre>\n\n<p>The output should have data from <code>GRT</code> which contains Branch as 21 and Local GL between range given in <code>VAT_Inclusion</code> (here its 40010).   </p>\n\n<ol>\n<li><p>GRT Table (source /raw file)</p>\n\n<p><code>Branch|Local_GL| Local_CUST_ID</code></p></li>\n<li><p>VAT_Inclusion Table: GL Range to be selected</p>\n\n<p><code>Branch|Local_GL_Start|Local_GL_end|Domicile|VATRATE</code></p></li>\n<li><p>Domicile Table</p>\n\n<p><code>Local_CUST_ID|Domicile</code></p></li>\n</ol>\n\n<p><br></p>\n\n<pre><code>select GRT.*,IIF(GRT.Branch=VAT_Inclusion.Branch) and (GRT.local_GL between AT_Inclusion.Local_GL_Start\nand AT_Inclusion.Local_GL_Start) and (VAT_Inclusion.Domicile=Domicile_out.Domicile),VAT_Inclusion.VATRATE, \"7\") from\nVAT_Inclusion, GRT, (select GRT.Local_CUST_ID, DOMICILE.Local_CUST_ID, DOMICILE.DOMICILE from GRT, DOMICILE\nwhere GRT.Local_CUST_ID=DOMICILE.Local_CUST_ID) AS Domicile_out\nwhere GRT.Branch=VAT_Inclusion.Branch\nAND GRT.local_GL between AT_Inclusion.Local_GL_Start and AT_Inclusion.Local_GL_Start\nAND VAT_Inclusion.Domicile=Domicile_out.Domicile\n</code></pre>\n\n<p>Request your help in resolving the issue. It is not showing VAT Rate as desired. Its only showing 7 as VAT Rate for all.</p>\n",
            "Tag": "sql,ms-access",
            "Answer": "<p>Your SQL had a couple spelling mistakes (AT instead of VAT), and the \")' before the 'AND' needs to be removed.  Try the following:</p>\n\n<pre><code>SELECT GRT.*, IIf([GRT].[Branch]=[VAT_Inclusion].[Branch] And ([GRT].[local_GL] Between [VAT_Inclusion].[Local_GL_Start] And [VAT_Inclusion].[Local_GL_Start]) And ([VAT_Inclusion].[Domicile]=[Domicile_out].[Domicile]),[VAT_Inclusion].[VATRATE],\"7\") AS Expr1\nFROM VAT_Inclusion, GRT, (select GRT.Local_CUST_ID, DOMICILE.Local_CUST_ID, DOMICILE.DOMICILE \nfrom GRT, DOMICILE \nwhere GRT.Local_CUST_ID=DOMICILE.Local_CUST_ID)  AS Domicile_out\nWHERE (((GRT.Branch)=[VAT_Inclusion].[Branch]) AND ((GRT.local_GL) Between [VAT_Inclusion].[Local_GL_Start] And [VAT_Inclusion].[Local_GL_Start]) AND ((VAT_Inclusion.Domicile)=[Domicile_out].[Domicile]));\n</code></pre>\n",
            "combined_token_ids": "60783#, 58065#, 975262#, 59284#, 1349368#, 1504#, 240301#, 21183#, 18799#, 1334579#, 253490#, 2421248#, 19743#, 966092#, 62181, 1287922"
        }
    ],
    [
        {
            "Id": 28963370,
            "CreationDate": "2015-03-10T12:10:18Z",
            "Score": 0,
            "Title": "Should i use IIF and ISNULL to select a default-value?",
            "Body": "<p>Is this the best way to select default value from the table if selecting value is <code>0</code> or <code>null</code>?</p>\n\n<pre><code>DECLARE @value INT = 15 \nDECLARE @defaultValue INT = 12\n\nSELECT IIF(ISNULL(@value,0) = 0, @defaultValue, @value)\n</code></pre>\n",
            "Tag": "sql,sql-server",
            "Answer": "<p>It can be a lot of arguments what is the best way and what it not, but\nfor me it is slightly more readable when using <code>case</code> syntax:</p>\n\n<pre><code>select case when @value is null then @defaultValue else @value end\n</code></pre>\n,,,,,<p>Specify \"best\". Since <code>IIF</code> works only in SQL-Server i'd use <code>CASE</code> which is ANSI SQL standard and works in every(?) rdbms:</p>\n\n<pre><code>SELECT  CASE WHEN ISNULL(@value,0) = 0 THEN  @defaultValue ELSE @value END\n</code></pre>\n\n<p>Actually <a href=\"https://msdn.microsoft.com/en-us/library/hh213574.aspx\" rel=\"nofollow\"><code>IIF</code></a> is even translated to <code>CASE</code>:</p>\n\n<blockquote>\n  <p>IIF is a shorthand way for writing a CASE expression ...\n  The fact that IIF is translated into CASE also has an impact on other\n  aspects of the behavior of this function....</p>\n</blockquote>\n\n<p>But the same is true for <code>ISNULL</code> which is also a <code>SQL-Server</code> function and could be replaced by <code>COALECSE</code>.</p>\n\n<p>By the way,  if you use <code>ISNULL</code> or <code>COALESCE</code> in a <code>WHERE</code>-clause, it  prevents the query optimizer from using an index. So then you should prefer:</p>\n\n<pre><code>SELECT  ...\nFROM dbo.TableName\nWHERE @value IS NOT NULL AND @value &lt;&gt; @value  \n</code></pre>\n\n<p>However, i prefer <code>ISNULL</code> over <code>COALESCE</code> since the latter has an issue if it contains a sub-query. It is executed twice whereas <code>ISNULL</code> executes it once. Actually <code>COALESCE</code> is also translated into <code>CASE</code>. You can read about that issue <a href=\"https://connect.microsoft.com/SQLServer/feedback/details/546437/coalesce-subquery-1-may-return-null\" rel=\"nofollow\">here</a>.</p>\n,,,,,<p>You can use <code>CASE</code> statement.</p>\n\n<pre><code>SELECT CASE WHEN @value IS NULL THEN @defaultValue ELSE @value END\n</code></pre>\n\n<hr>\n\n<p>Or <code>COALESCE</code> expression</p>\n\n<pre><code>SELECT COALESCE(@value,@defaultValue)\n</code></pre>\n,,,,,<p>You can use the <a href=\"https://msdn.microsoft.com/en-us/library/ms190349.aspx\" rel=\"nofollow\">COALESCE</a>. It evaluates the arguments in order and returns the current value of the first expression that initially does not evaluate to <code>NULL</code>. It is used for this purpose to get the first <code>not null</code> value.</p>\n\n<pre><code> SELECT COALESCE(@value,@defaultValue)\n</code></pre>\n\n<p>But keep in mind,</p>\n\n<blockquote>\n  <p>If all arguments are NULL, COALESCE returns NULL. At least one of the\n  null values must be a typed NULL.</p>\n</blockquote>\n\n<p>You can also use the <code>ISNULL</code> but there is difference between both of them that is as listed below,</p>\n\n<p><strong>Comparing COALESCE and ISNULL</strong>   </p>\n\n<blockquote>\n  <p>1) The <code>ISNULL</code> function and the <code>COALESCE</code> expression have a similar\n  purpose but can behave differently. Because <code>ISNULL</code> is a function, it\n  is evaluated only once. As described above, the input values for the\n  <code>COALESCE</code> expression can be evaluated multiple times.<br>\n  2) Data type\n  determination of the resulting expression is different. <code>ISNULL</code> uses\n  the data type of the first parameter, <code>COALESCE</code> follows the <code>CASE</code>\n  expression rules and returns the data type of value with the highest\n  precedence.<br>\n  3) The <code>NULLability</code> of the result expression is\n  different for <code>ISNULL</code> and <code>COALESCE</code>. The <code>ISNULL</code> return value is\n  always considered <code>NOT NULLable (assuming the return value is a non-nullable one)</code> whereas <code>COALESCE</code> with non-null parameters is\n  considered to be <code>NULL</code>. So the expressions <code>ISNULL(NULL, 1)</code> and\n  <code>COALESCE(NULL, 1)</code> although equivalent have different <code>nullability</code>\n  values. This makes a difference if you are using these expressions in\n  computed columns, creating key constraints or making the return value\n  of a scalar UDF deterministic so that it can be indexed as shown in\n  the following example.</p>\n</blockquote>\n\n<p>If you are planning to use the sub queries in the expression to  check for the <code>NULL</code> then you better of using the <code>ISNULL</code> as <code>COALESCE</code> will evaluate same query multiple times. </p>\n",
            "combined_token_ids": "421759#, 3360#, 60783#, 58065#, 57688#, 432369#, 21183#, 416536#, 3104#, 3764541#, 62181, 1804314"
        }
    ],
    [
        {
            "Id": 29118360,
            "CreationDate": "2015-03-18T09:31:43Z",
            "Score": 0,
            "Title": "Issue Related to IIF Condition in SSRS Expression",
            "Body": "<p>I have ASP.NET MVC Application having SSRS Reports..</p>\n\n<p>I have written following code in an Expression :</p>\n\n<pre><code>=iif(Fields!Aggr3.Value is nothing,\"\", iif(cStr(Fields!Aggr3.Value).IndexOf(\".\") &gt;=0 , Format(Fields!Aggr3.Value,\"C\"),Fields!Aggr3.Value))\n</code></pre>\n\n<p>Field Aggr3 contains Dynamic Values it can be either \"Null\" or Decimal Value or Integer Value..\nIf value is Decimal I want to Format it with $ Currency. otherwise if value is interger value then i want to saw it as normal value.</p>\n\n<p>so i written above expression.. but when generating Report column value displays <code>#Error</code></p>\n\n<p>i changed iif Condition to Switch condition as follows :</p>\n\n<pre><code>=Switch(IsNothing(Fields!Aggr2.Value), \"\", \nnot IsNothing(Fields!Aggr2.Value),\nSwitch(cstr(Fields!Aggr2.Value).IndexOf(\".\") &gt;=0,Format(Fields!Aggr2.Value,\"C\"),\ncstr(Fields!Aggr2.Value).IndexOf(\".\") &lt;0,Fields!Aggr2.Value))\n</code></pre>\n\n<p>but it also throws an Error..</p>\n\n<p>what is the error and how to solve it ??</p>\n\n<p>Thanks</p>\n",
            "Tag": "c#,asp.net-mvc,reporting-services,ssrs-2008",
            "Answer": "<p>Many people have misunderstanding of the way IIF works. In IIF, all the parameters are evaluated whether the first parameter is true or false, so in your case, if the Fields!Aggr3.Value is nothing, it will still evaluate the expression \"iif(cStr(Fields!Aggr3.Value).IndexOf(\".\") >=0 , Format(Fields!Aggr3.Value,\"C\"),Fields!Aggr3.Value)\", and definitely, it will show an error if it tries to evaluate this expression (when Aggr3 is null). Please see this article for more info: <a href=\"http://softwarecafeblog.blogspot.com/2010/04/iff-statement-in-vbnet.html\" rel=\"nofollow\">http://softwarecafeblog.blogspot.com/2010/04/iff-statement-in-vbnet.html</a></p>\n\n<p>One suggestion would be to put your condition as a normal \"if\" in the report code. for information on how to add report code see this article <a href=\"https://msdn.microsoft.com/en-us/library/ms156028.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/ms156028.aspx</a></p>\n,,,,,<p>Your issue here is with using the .IndexOf method to test for a \".\" - this causes an error when used on a null value. You should use the SSRS function inStr() instead, like this:</p>\n\n<pre><code>inStr(cStr(Fields!Aggr3.Value), \".\") &gt;=0\n</code></pre>\n\n<p>This should avoid the errors - I tested this using some sample data and it seemed fine.</p>\n",
            "combined_token_ids": "256768#, 633075#, 21183#, 58065#, 1363882#, 20365#, 142687#, 1883424#, 3168, 2191993, 9996237, 808690"
        }
    ],
    [
        {
            "Id": 29344570,
            "CreationDate": "2015-03-30T11:04:55Z",
            "Score": 0,
            "Title": "IIF statement error when divding by 0",
            "Body": "<p>Ok so I have an #ERROR when dividing by 0 so I have tried to capture this using the following code</p>\n\n<pre><code>=IIf(Code.SumLookup(LookupSet(Fields!region.Value, Fields!region.Value, Fields!X.Value, \"Dataset2\")))=0,\"-\", Fields!Bad.Value/(Code.SumLookup(LookupSet(Fields!region.Value, Fields!region.Value, Fields!ticket_count.Value, \"Dataset2\")))\n</code></pre>\n\n<p>So this should do the following: If [value in FieldsX in \"Dataset2\"] = 0, then show a \"<strong>-</strong>\" , else do the calculation [Fields!Bad.Value/FieldX in \"Dataset2\"]</p>\n\n<p>But for some reason this just fails upon attempting to run: [BC30455] Argument not specified for parameter 'FalsePart' of 'Public Function IIf(Expression As Boolean, TruePart As Object, FalsePart As Object) As Object'.</p>\n\n<p>Is there something wrong with how I have formatted the Iif statement? Because the false calculation runs fine when used independently.</p>\n\n<p>Any Ideas?</p>\n",
            "Tag": "reporting-services,syntax,reportbuilder3.0,iif,ssrs-expression",
            "Answer": "<p>Check your brackets properly. It's not proper.\nBelow code may work for you.</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>=IIf(Code.SumLookup(LookupSet(Fields!region.Value, Fields!region.Value, Fields!X.Value, \"Dataset2\"))=0,\"-\", Fields!Bad.Value/(Code.SumLookup(LookupSet(Fields!region.Value, Fields!region.Value, Fields!ticket_count.Value, \"Dataset2\"))))</code></pre>\r\n</div>\r\n</div>\r\n</p>\n",
            "combined_token_ids": "58065#, 1365849#, 261729#, 133114#, 645231#, 21299#, 1536#, 9996237, 438895, 5941156, 58065, 6029868"
        }
    ],
    [
        {
            "Id": 29867940,
            "CreationDate": "2015-04-25T16:43:36Z",
            "Score": 0,
            "Title": "How to convert or rewrite Access IIF Statement in SQL Server",
            "Body": "<p>I thought the IIf statements returns one value if the condtion is true or false BUT This IIf statement in Access returns the field and it values. </p>\n\n<pre><code>IIf([A1]![KPr],[A1]![Kat],IIf([Data2]![Kat],[Data2]![Kat],[Data1]![Kat])),\n</code></pre>\n\n<p>the table left join in the from clause \nI'm try to realize this statement in <code>SQL Server</code> using <code>CASE WHEN</code> but it also accepts a true or false condition. </p>\n\n<p>How can I understand and realize this statement.</p>\n",
            "Tag": "sql-server,ms-access",
            "Answer": "<p>IIf function in VB, VBA, and Access is the same as  ps_prakash02 wrote in the comment: <code>iif(condition, value_if_true, value_if_false)</code>. this means that if the condition evaluates to true, the <code>value_if_true</code> is returned, otherwise <code>value_if_false</code> returns.<br>\nSo a translation of IIf to t-sql is simply <code>CASE WHEN condition THEN value_if_true ELSE _value_if_false END</code>.</p>\n\n<p>I'm not so sure what <code>[A1]![KPr]</code> means in access, I'm guessing it's KPr column value of table A1 or something like this, so I'll leave them as they are in your question and just replace the <code>IIF</code> with <code>CASE</code> in my answer:</p>\n\n<pre><code>CASE WHEN [A1]![KPr] THEN [A1]![Kat]\n     ELSE \n         CASE WHEN [Data2]![Kat] THEN [Data2]![Kat] \n              ELSE [Data1]![Kat]\n         END\n END\n</code></pre>\n\n<p><strong>Note:</strong> <a href=\"https://msdn.microsoft.com/en-us/library/hh213574.aspx\" rel=\"nofollow\">In SQL Server 2012 Microsoft included IIF in t-sql.</a></p>\n",
            "combined_token_ids": "63853#, 21183#, 678677#, 21243#, 664139#, 421172#, 58065#, 1365849#, 20365#, 62181#, 432183#, 1804314, 1287922"
        }
    ],
    [
        {
            "Id": 30309220,
            "CreationDate": "2015-05-18T17:15:40Z",
            "Score": 0,
            "Title": "Access IIF statement using dates",
            "Body": "<p>Can someone help me with why I'm getting result of #Error on this IIf statement?</p>\n\n<pre><code>ENDDT: IIf([dbo_Pr_EmpPayData_T]![dteTerminationDate]=\"9/9/9999\",\nNull,Format([dbo_Pr_EmpPayData_T]![dteTerminationDate],\"mm/dd/yyyy\"))\n</code></pre>\n\n<p>What I want to do....  If the field contains 9/9/9999 do nothing, give me a blank field.  Otherwise, I want the date in the field and I wanted it formatted mm/dd/yyyy.</p>\n",
            "Tag": "date,ms-access,iif",
            "Answer": "<p>You need to enclose your 9/9/9999 with # instead of in quotes.</p>\n",
            "combined_token_ids": "421172#, 58065#, 1365849#, 60783#, 130118#, 130118, 1287922, 58065"
        }
    ],
    [
        {
            "Id": 31786440,
            "CreationDate": "2015-08-03T11:47:44Z",
            "Score": 1,
            "Title": "Creating RFC-4716 specific dsa public-key using openssl",
            "Body": "<p>For the purpose of ssh using public key authentication,</p>\n\n<p>DSA-2048 keypair has been generated using openssl and both are stored locally in PEM format.\nNow, for configuring in the server side (authorized_keys), public key has to be in the RFC-4716 format.</p>\n\n<p>Usually as a practice, for getting this key, ssh-keygen is typically used with options as,</p>\n\n<pre><code>ssh-keygen -y -f private_key.pem\n</code></pre>\n\n<p>which returns the corresponding public key(RFC-4716) that has to be configured in the server side.</p>\n\n<p>Without ssh-keygen, Is there a possibility in openssl itself to generate the RFC-4716 specific public key from the openssl generated public (or) private key?</p>\n",
            "Tag": "ssh,openssl,public-key,dsa,ssh-keygen",
            "Answer": NaN,
            "combined_token_ids": "948701#, 536250#, 918934#, 58065#, 1700123#, 60783#, 673255#, 61435, 673255, 1700123, 58065, 1755002"
        }
    ],
    [
        {
            "Id": 31977860,
            "CreationDate": "2015-08-13T01:02:49Z",
            "Score": 1,
            "Title": "How to load DSA PublicKey using go stdlib",
            "Body": "<p>I have a PEM encoded DSA public key. I need this DSA key so I can verify incoming data. But I have yet to figure out how to load the key using go crypto library (I am not a crypto expert but from what I'm reading online, DSA is not a popular choice anymore).</p>\n\n<p>I can decode the PEM in to its bytes. Which, from what I understand, are DER-encoded ASN.1. How can I put the PEM blocks in to a golang <code>dsa.PublicKey</code>?</p>\n\n<p>Here's a runnable sample: <a href=\"http://play.golang.org/p/8Ma2qwhT31\" rel=\"nofollow\">http://play.golang.org/p/8Ma2qwhT31</a></p>\n\n<p>The code:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"encoding/pem\"\nimport \"encoding/asn1\"\nimport \"crypto/dsa\"\n\nvar signingPubKey = []byte(`-----BEGIN PUBLIC KEY-----\nMIICIDANBgkqhkiG9w0BAQEFAAOCAg0AMIICCAKCAgEApSmU3y4DzPhjnpOrdpPs\ncIosWJ4zSV8h02b0abLW6nk7cnb5jSwBZKLrryAlF4vs+cF1mtMYjX0QKtEYq2V6\nWVDnoXj3BeLYVbhsHuvxYmwXmAkNsSnhMfSCxsck9y6zuNeH0ovzBD90nISIJw+c\nVAnUt0dzc7YKjBqThHRAvi8HoGZlzB7Ryb8ePSW+Mfr4jcH3Mio5T0OH3HTavN6Y\nzpnohzQo0blwtwEXZOwrNPjQNrSigdPDrtvM32+hLTIJ75Z2NbIRLBjNlwznu7dQ\nAsb/AiPTHXihxCRDm+dH70dps5JfT5Zg9LKsPhANk6fNK3e4wdN89ybQsBaswp9h\nxzORVD3UiG4LuqP4LMCadjoEazShEiiveeRBgyiFlIldybuPwSq/gUuFveV5Jnqt\ntxNG6DnJBlIeYhVlA25XDMjxnJ3w6mi/pZyn9ZR9+hFic7Nm1ra7hRUoigfD/lS3\n3AsDoRLy0xZqCWGRUbkhlo9VjDxo5znjv870Td1/+fp9QzSaESPfFAUBFcykDXIU\nf1nVeKAkmhkEC9/jGF+VpUsuRV3pjjrLMcuI3+IimfWhWK1C56JJakfT3WB6nwY3\nA92g4fyVGaWFKfj83tTNL2rzMkfraExPEP+VGesr8b/QMdBlZRR4WEYG3ObD2v/7\njgOS2Ol4gq8/QdNejP5J4wsCAQM=\n-----END PUBLIC KEY-----`)\n\nfunc main() {\n    block, _ := pem.Decode(signingPubKey)\n    if block == nil {\n        fmt.Errorf(\"expected block to be non-nil\", block)\n        return\n    }\n\n    var pubkey dsa.PublicKey\n\n    _,err := asn1.Unmarshal(block.Bytes, &amp;pubkey)\n    if (err != nil ){\n        fmt.Errorf(\"could not unmarshall data: `%s`\", err)\n    }\n\n    fmt.Printf(\"public key param P: %d\\n\", pubkey.Parameters.P)\n    fmt.Printf(\"public key param Q: %d\\n\", pubkey.Parameters.Q)\n    fmt.Printf(\"public key param G: %d\\n\", pubkey.Parameters.G)\n    fmt.Printf(\"public key Y: %d\\n\", pubkey.Y)\n\n    fmt.Printf(\"done\")\n}\n</code></pre>\n\n<p>Which outputs nil for all values, so obviously the Unmarshal call isn't doing what I want (or something is wrong earlier in the pipeline).</p>\n",
            "Tag": "go,cryptography,dsa",
            "Answer": NaN,
            "combined_token_ids": "63853#, 21183#, 127020#, 58065#, 1350491#, 60783#, 20364#, 408354#, 20364, 3202756, 58065"
        }
    ],
    [
        {
            "Id": 32385720,
            "CreationDate": "2015-09-03T21:27:40Z",
            "Score": 1,
            "Title": "IIF statement missing something",
            "Body": "<p>I'm way out of my element with SSRS Expressions.  I'm hoping someone could lend me a hand.</p>\n\n<p>I have 2 name fields:</p>\n\n<ul>\n<li><code>ContactName</code> </li>\n<li><code>BusinessName</code></li>\n</ul>\n\n<p>If <code>ContactName</code> is NOT NULL then only use the <code>ContactName</code>.\nHowever, if <code>ContactName</code> is NULL and <code>BusinessName</code> is NOT NULL then use the <code>BusinessName</code>.</p>\n\n<p>I tried the following:</p>\n\n<pre><code>    =IIF(NOT\n         Fields!ContactName.Value Is Nothing, \n         Fields!ContactName.Value, \n         Fields!BusinessName.Value\n        )\n</code></pre>\n\n<p>However, it isn't picking up when I only have a <code>BusinessName</code>.</p>\n\n<p>What do I need to do to also display the <code>BusinessName</code> when I only have a <code>BusinessName</code>?</p>\n\n<p><strong>Just as an update:</strong></p>\n\n<p>The answer was a combination of the IIF statement and a check to see if the value was also an empty string.</p>\n",
            "Tag": "reporting-services,ssrs-2008",
            "Answer": "<p>In SSRS, <strong>ISNOTHING</strong> is a function that requires an argument.</p>\n\n<p>Your expression just needs a little change to put your field in the argument:</p>\n\n<pre><code> =IIF(NOT ISNOTHING(Fields!ContactName.Value), \n         Fields!ContactName.Value, \n         Fields!BusinessName.Value\n        )\n</code></pre>\n",
            "combined_token_ids": "58065#, 1365849#, 139820#, 1344080#, 9996237, 808690"
        }
    ],
    [
        {
            "Id": 34418730,
            "CreationDate": "2015-12-22T15:04:22Z",
            "Score": -1,
            "Title": "IIf function doesn't work (Visual Studio 2013 BI Tools)",
            "Body": "<p>I'm using Visual Studio 2013 (with SQL-Server 2014, Reporting Services and BI Tools) and I try to add an simple \"iif\" expression but the compiler returns an Error (value = -1073741511)</p>\n\n<p>I tried:</p>\n\n<pre><code>= IIf ( 3000 &gt; 1000, \"True\", \"False\" )\n</code></pre>\n\n<p>Is it possible that the compiler doesn't support these kind of expression or are there similar ones?</p>\n\n<p>What I need is an expression to get a value from my db where the id = x</p>\n\n<pre><code>= IIf ( Fields!ID.Value = 1 , Fields!Value.Value, 0 )\n</code></pre>\n\n<p><a href=\"http://i.stack.imgur.com/0UiJt.png\" rel=\"nofollow\"><img src=\"http://i.stack.imgur.com/0UiJt.png\" alt=\"enter image description here\"></a></p>\n",
            "Tag": "visual-studio-2013,reporting-services,sql-server-2014,bi-tool",
            "Answer": "<p>It was a problem with the compiler itself</p>\n\n<p>See this post for more infos: <a href=\"http://stackoverflow.com/questions/33670196/visual-basic-command-line-compiler-has-stopped-working\">Visual Basic Command Line Compiler has stopped working</a></p>\n\n<p>anyway thanks!</p>\n",
            "combined_token_ids": "58065#, 975262#, 20175#, 138215#, 1280#, 426418#, 61826#, 19299#, 260651#, 7492762, 9996237, 4187218, 626522"
        }
    ],
    [
        {
            "Id": 34963140,
            "CreationDate": "2016-01-23T11:56:10Z",
            "Score": 0,
            "Title": "Adding a calculated IIF to an Access table due to IIF limitations",
            "Body": "<p>At the moment I am looking to populate ca. 30 IIF results into a column in a given table in order to work around the 10-14 IIF limit in Access. The same formula works (slowly) in Excel but it is tempermental as I am handling ca. 200k lines of data each time it runs. I already have an established table which updates daily with my key reporting dataset.</p>\n\n<p>Some notes:</p>\n\n<ul>\n<li><p>I can add a new table if required and then build this off a join or dlookup</p></li>\n<li><p>The issue I am having in using a new table (forgive my ignorance, I am pretty new to SQL) is that I am trying to scrape certain values out of a concatenated field using LIKE. So...</p></li>\n</ul>\n\n<p>IIF(field LIKE 'abc','abc,\nIIF(field2 LIKE 'def', 'def,\nEtc</p>\n\n<p>In a hierarchy where anything scraped further up the IF needs to trump anything below it. This worked fine (albeit slowly) in Excel but the dataset is growing. The desired result is a column in a table which gives my full output per row so row1 is 'abc', 2 is 'def', 3 is 'abc' as required based on conditions.</p>\n\n<p>I have tried to do this on Access 2007 and it is having none of it. Additionally, I tried to store it in query as 3 IIF expressions that I then rolled up into 1 final 1 but this is missing values for no explicable reason (and is also pretty heavy on performance - this is the shiban solution in another post where I define set1, set2 and set3 then assign values to hierarchy based on set1, set2 and set3.)</p>\n\n<p>Any help would be greatly appreciated.</p>\n\n<p>Thanks,</p>\n\n<p>J</p>\n",
            "Tag": "sql,ms-access-2007,iif",
            "Answer": NaN,
            "combined_token_ids": "407025#, 3104#, 1329540#, 58065#, 21183#, 19861#, 421172#, 239375#, 59559#, 1854262#, 62181, 3292163, 58065"
        }
    ],
    [
        {
            "Id": 35306580,
            "CreationDate": "2016-02-10T04:02:22Z",
            "Score": 0,
            "Title": "Nested IIF statement to produce 1 of 3 results",
            "Body": "<p>I am trying to piece together a nested \"IIF\" statement to produce one of three Values but my line is not working</p>\n\n<pre><code>=IIF(Fields!LeaseNumber.value = \"\", \"Vacant\",Fields!tenantName.value) AND (IIF(Fields!tenantName.Value =\"\",Fields!LeaseDBA.Value, Fields!tenantName.Value))\n</code></pre>\n\n<p>My expected outcome should be: </p>\n\n<p>If No lease# - \"Vacant\"</p>\n\n<p>if no tenantName - \"LeaseDBA\"</p>\n\n<p>all other rows just give me - \"tenantname\"</p>\n\n<p>All the other questions I reviewed didn't seem to match this type of IIF clause.\nAny help really is appreciated.</p>\n",
            "Tag": "reporting-services,expression,ssrs-2008-r2,iif",
            "Answer": "<p>If No lease# - \"Vacant\" (If there is no LeaseNumber then show \"Vacant\" -String only)</p>\n\n<p>If no tenantName - \"LeaseDBA\" (If there is not tenantName then show <code>Fields!LeaseDBA.Value</code> </p>\n\n<p>And for other rows just give me <code>Fields!tenantName.Value</code> </p>\n\n<p>If this is you want then try below expression.</p>\n\n<pre><code>IIF(Trim(CStr(Fields!LeaseNumber.Value))=\"\",\"Vacant\",CStr(Fields!tenantName.Value)) &amp; IIF(Trim(CStr(Fields!tenantName.Value))=\"\",Fields!LeaseDBA.Value,CStr(Fields!tenantName.Value))\n</code></pre>\n,,,,,<p>I've actually recently just tried to expalain how the IIF expression works and how to nest them. <a href=\"http://stackoverflow.com/a/35289515/4579864\">http://stackoverflow.com/a/35289515/4579864</a></p>\n\n<p>To check if a value is null or empty, you're better off using one of these functions:</p>\n\n<ul>\n<li><p>You can use <code>IsNothing()</code> to check if there is a value. Applied to your example would result to this:</p>\n\n<pre><code>=IIF(IsNothing(Fields!LeaseNumber.value)\n,\"Vacant\" \n,IIF(IsNothing(Fields!tenantName.Value), Fields!LeaseDBA.Value, Fields!tenantName.Value))\n</code></pre></li>\n<li><p>You can calculate the length of your value with <code>Len()</code> and then check if it is larger than 0. </p>\n\n<pre><code>=IIF(Len(Fields!LeaseNumber.value) &gt; 0 \n,IIF(Len(Fields!tenantName.Value) &gt; 0, Fields!tenantName.Value, Fields!LeaseDBA.Value)\n,\"Vacant\" )\n</code></pre></li>\n</ul>\n",
            "combined_token_ids": "414679#, 58065#, 1365849#, 21183#, 642857#, 1568#, 19743#, 1632#, 440561#, 9996237, 1883424, 1935315, 58065"
        }
    ],
    [
        {
            "Id": 36802800,
            "CreationDate": "2016-04-22T20:28:29Z",
            "Score": 1,
            "Title": "Using nested iif statements to subtract two columns of data",
            "Body": "<p>Working in Visual Studio 2012 to create a SSRS Business Intelligence Services Report.</p>\n\n<p>Trying to do something like below where based on the value of one column, subtract the value of another column. </p>\n\n<pre><code>=iif(Fields!ACADEMIC_YEAR.Value=Parameters!ACADEMIC_YEAR.Value, Fields!TotalProspects_Dom.Value-iif(Fields!ACADEMIC_YEAR.Value=Parameters!ACADEMIC_YEAR.Value-1,Fields!TotalProspects_Dom.Value, 0),0)\n</code></pre>\n\n<p>Basically my table looks like:\n<a href=\"http://i.stack.imgur.com/9b1FI.png\" rel=\"nofollow\"><img src=\"http://i.stack.imgur.com/9b1FI.png\" alt=\"Visual Studio Table Screencap\"></a></p>\n\n<p>essentially the table for the report is two rows, the current academic year and the previous academic year and I have to compare the two. Each row is made of columns representing the data for domestic and international data for a larger group. </p>\n",
            "Tag": "sql-server,reporting-services",
            "Answer": "<p>I think you just need to have separate IIFs to determine the year.</p>\n\n<pre><code>= SUM(IIF(Fields!ACADEMIC_YEAR.Value = Parameters!ACADEMIC_YEAR.Value, Fields!TotalProspects_Dom.Value, 0) \n- SUM(IIF(Fields!ACADEMIC_YEAR.Value = Parameters!ACADEMIC_YEAR.Value - 1, Fields!TotalProspects_Dom.Value, 0)\n</code></pre>\n",
            "combined_token_ids": "251185#, 139446#, 58065#, 1365849#, 21183#, 963112#, 64237#, 431802#, 19743#, 128130#, 1804314, 9996237"
        }
    ],
    [
        {
            "Id": 36839260,
            "CreationDate": "2016-04-25T11:28:07Z",
            "Score": 0,
            "Title": "Why IIF is evaluating the two sides ? .NET",
            "Body": "<p>I'm trying to use the IIF in a simple mode:</p>\n\n<pre><code> Dim MyList As List(Of Double) = New List(Of Double)\n Dim ret As Double\n\n ret = IIf(MyList.Count &gt; 0, MyList.Max(), 0)\n</code></pre>\n\n<p>There is no elements in MyList but a System.InvalidOperationException is thrown, \"Sequence has no elements\".\nWhy IIF is evaluating the two sides ?</p>\n\n<p>Thanks!</p>\n",
            "Tag": ".net,sequence,iif",
            "Answer": "<p>Because <a href=\"https://msdn.microsoft.com/en-us/library/27ydhh0d(v=vs.90).aspx\" rel=\"nofollow\">that</a> is the old VB6 function, use the <a href=\"https://msdn.microsoft.com/en-us/library/bb513985.aspx\" rel=\"nofollow\"><code>If</code> operator</a> which does short-circuit evaluation:</p>\n\n<pre><code>ret = If(MyList.Count &gt; 0, MyList.Max(), 0)\n</code></pre>\n",
            "combined_token_ids": "64514#, 58065#, 18799#, 954911#, 58632#, 64237#, 128017#, 2016#, 128465#, 128465, 940777, 58065"
        }
    ],
    [
        {
            "Id": 36868170,
            "CreationDate": "2016-04-26T14:39:08Z",
            "Score": 0,
            "Title": "ssrs nested IIF to compare the two Data sets",
            "Body": "<p>I need create a Delta Report which is based on the two data sets i.e DataSet1 and DataSet2.\nI need take DataSet2 as reference if there is any change in any field value in DataSet1 I need change the color of the text box.\ncan anybody help me in this I wrote some code but its throwing Error.</p>\n\n<pre><code>=IIF(Fields!CIF.value, \"DataSet1\" = Fields!CIF.value, \"DataSet2\" AND Fields!Account_ID.value,\"DataSet1\" = Fields!Account_ID.value,\"DataSet2\", \n                        IIF( Fields!Account_balance.value, \"DataSet1\" &lt;&gt; Fields!Account_balance.value, \"DataSet2\",\"Yellow\",\"Transparent\"),\"Transparent\",\"Transparent\")\n</code></pre>\n",
            "Tag": "reporting-services,ssrs-2008",
            "Answer": "<p>You can't mix datasets.</p>\n\n<p>This will only work if your datasets each only have one row of data. Otherwise you'll need to figure out how to isolate the value you need.</p>\n\n<pre><code>=IIF(MAX(Fields!CIF.value, \"DataSet1\") = MAX(Fields!CIF.value, \"DataSet2\") AND MAX(Fields!Account_ID.value, \"DataSet1\") = MAX(Fields!Account_ID.value, \"DataSet2\"), \n    IIF(MAX(Fields!Account_balance.value, \"DataSet1\") &lt;&gt; MAX(Fields!Account_balance.value, \"DataSet2\"), \"Yellow\", \"Transparent\"), \"Transparent\")\n</code></pre>\n\n<p>Usually you'd have one dataset in a table and then look up the corresponding value in the other dataset.</p>\n\n<p>If your <strong>CIF</strong> and <strong>Account ID</strong> are the common identifiers and you want to compate the Account Balances of each, I would base the table on dataset 1 and then bring in the value from dataset2 to compare. Combine the CIF and Account ID into a single text string for comparison.</p>\n\n<p>Your color expression would then be something like:</p>\n\n<pre><code>=Lookup(Fields!CIF.value &amp; \"|\" &amp; Fields!Account_ID.value, Fields!CIF.value &amp; \"|\" &amp; Fields!Account_ID.value, Account_balance.value, \"DataSet2\")\n</code></pre>\n\n<p><strong>SSRS:</strong></p>\n\n<blockquote>\n  <p>Use Lookup to retrieve the value from the specified dataset for a\n  name-value pair where there is a 1-to-1 relationship. For example, for\n  an ID field in a table, you can use Lookup to retrieve the\n  corresponding Name field from a dataset that is not bound to the data\n  region.</p>\n</blockquote>\n,,,,,<p>Another approach would be to do this in a stored procedure and return the results as one dataset.  For example, assume I have 10 fields in the tables.  I can create a hash of the data for each record:</p>\n\n<pre><code>select\n    CASE WHEN chkHash2 = chkHash1 THEN 0 ELSE 1 END as 'ChgFlag'\n    ,a.*\nFROM\n(\n    select\n        HASHBYTES('md5', t2.Field1 + t2.Field2 + ... + t2.Field10) as 'chkHash2'\n        ,HASHBYTES('md5', t1.Field1 + t1.Field2 + ... + t1.Field10) as 'chkHash1'\n        ,t1.Field1, t1.Field2, ... t1.Field10\n    From Table2 t2\n    LEFT JOIN Table1 t1 on t1.ID = t2.ID\n) a\n</code></pre>\n\n<p>Big Assumption ... both tables have an ID that is unique and related.\nThis will give you a result set of Table1 (dataset1) fields and a flag that will tell you when any field has changed from Table2 (dataset2).</p>\n\n<p>Depending on your application, this could be easier and faster.  I always try to do the WORK in SQL as opposed to SSRS.</p>\n",
            "combined_token_ids": "142687#, 139446#, 58065#, 21183#, 645667#, 58632#, 64237#, 128130#, 62177#, 9996237, 808690"
        }
    ],
    [
        {
            "Id": 36895270,
            "CreationDate": "2016-04-27T16:09:30Z",
            "Score": 0,
            "Title": "SSRS SUM IIf from TODAY, WEEK, MONTH, YEAR",
            "Body": "<p>I'm trying to count how many incidents have been created <code>TODAY</code>, for the <code>WEEK</code>, <code>YEAR</code> and <code>TOTAL</code>.</p>\n\n<p>I've been able to get the TOTAL using: </p>\n\n<pre><code>=Count(Fields!Issue_ID.Value, \"My_Data_Set\") \n</code></pre>\n\n<p>but I have not been successful getting the total COUNT for how many incidents have been created for: TODAY, WEEK, YEAR against <code>IncidentDateTime</code> field.</p>\n\n<p><a href=\"http://i.stack.imgur.com/LvTo1.jpg\" rel=\"nofollow\"><img src=\"http://i.stack.imgur.com/LvTo1.jpg\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"http://i.stack.imgur.com/1jpas.jpg\" rel=\"nofollow\"><img src=\"http://i.stack.imgur.com/1jpas.jpg\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"http://i.stack.imgur.com/LvTo1.jpg\" rel=\"nofollow\">http://i.stack.imgur.com/LvTo1.jpg</a></p>\n\n<p><a href=\"http://i.stack.imgur.com/1jpas.jpg\" rel=\"nofollow\">http://i.stack.imgur.com/1jpas.jpg</a></p>\n",
            "Tag": "reporting-services,ssrs-2008,ssrs-2012",
            "Answer": "<p>Use these expressions.</p>\n\n<p>For today:</p>\n\n<pre><code>=SUM(IIF(Fields!IncidentDateTime.Value=Today.Date,1,0),\"DataSetName\")\n</code></pre>\n\n<p>For Year:</p>\n\n<pre><code>=SUM(IIF(YEAR(Fields!IncidentDateTime.Value)=Today.Year,1,0),\"DataSetName\")\n</code></pre>\n\n<p>For Week:</p>\n\n<pre><code>=SUM(IIF(DATEPART(DateInterval.WeekOfYear,Fields!IncidentDateTime.Value)=\nDATEPART(DateInterval.WeekOfYear,Today),1,0),\"DataSetName\")\n</code></pre>\n\n<p>For Month:</p>\n\n<pre><code>=SUM(IIF(MONTH(Fields!IncidentDateTime.Value)=Today.Month,1,0),\"DataSetName\")\n</code></pre>\n\n<p>Let me know if this helps.</p>\n",
            "combined_token_ids": "142687#, 63209#, 58065#, 136712#, 253350#, 130876#, 255525#, 133113#, 9996237, 808690, 795851"
        }
    ],
    [
        {
            "Id": 37199730,
            "CreationDate": "2016-05-13T01:05:05Z",
            "Score": 0,
            "Title": "Trying to use IIF",
            "Body": "<p>Trying to use IIF instead of a CASE.</p>\n\n<pre><code>IIF(ISEMPTY([month part]) or ISEMPTY([Current Month]),null,\nIIF([month part] &gt;= [Current Month]),[Measures].[Current Forecast],\nIIF([month part] &lt; [Current Month],[Measures].[Qty Shipped],null))\n</code></pre>\n\n<p>I'm having a problem where the qty shipped is blank in <code>[month part] &gt;= [Current Month]</code> logic, and Current Forecast is Empty in [month part] &lt; [Current Month] logic and it throws my Grand Total to #error! in calculated measure. I need a way to make sure months that have no values doesn't effect \nGrand Total when I view in Browser. The calculated measure works to produce \neverything except a Total.</p>\n\n<p>Thanks</p>\n",
            "Tag": "ssas",
            "Answer": NaN,
            "combined_token_ids": "427539#, 21183#, 60783#, 58065#, 59475"
        }
    ],
    [
        {
            "Id": 37420670,
            "CreationDate": "2016-05-24T17:57:01Z",
            "Score": 0,
            "Title": "DSA algorithm : Sign in PHP",
            "Body": "<p>I need to sign a data on my server in php, and verify the signed data on my Java desktop application. My issue is that I don't succeed to generate a key that both languages accept...</p>\n\n<p>My first try was to generate the key with Java <a href=\"https://docs.oracle.com/javase/7/docs/api/java/security/KeyPairGenerator.html\" rel=\"nofollow\" title=\"KeyPairGenerator\">KeyPairGenerator</a>, but as shown in <a href=\"http://stackoverflow.com/questions/37401519/signing-with-a-private-key-as-a-string-in-php\" title=\"that question\">that question</a>, I couldn't make openssl to read the key.</p>\n\n<p>Now I generated the keys with openssl like that :</p>\n\n<pre><code>$openssl dsaparam 512 &lt; /dev/random &gt; dsaparam.pem\n$openssl gendsa dsaparam.pem -out dsa_priv.pem\n$openssl dsa -in dsa_priv.pem -pubout -out dsa_pub.pem\n</code></pre>\n\n<p>I now try to sign something with this code :</p>\n\n<pre><code>&lt;?php\n$data = \"test\";\n\n$pkeyid = openssl_pkey_get_private(\"dsa_priv.pem\");\necho openssl_sign($data, $signature, $pkeyid);\necho \"&lt;br/&gt;\";\necho $signature;\n?&gt;\n</code></pre>\n\n<p>Result ?</p>\n\n<pre><code>openssl_sign(): supplied key param cannot be coerced into a private key in ...\n</code></pre>\n\n<p>What am I doing wrong ? Can anyone help me generate a working DSA key and sign something with it ?</p>\n",
            "Tag": "php,sign,php-openssl",
            "Answer": "<p>You are missing one important thing here. The <code>openssl_pkey_get_private</code> method takes either key as a string or a file with <code>file://</code> protocol. The following example works as expected:</p>\n\n<pre><code>$data = \"test\";\n\n$pkeyid = openssl_pkey_get_private(\"file://dsa_priv.pem\");\nopenssl_sign($data, $signature, $pkeyid);\necho \"\\nSignature: \" . base64_encode($signature) . \"\\n\";\n</code></pre>\n\n<p>And produces:</p>\n\n<p><code>Signature: MCwCFBpkSESngh+6ooMQZj7i+76t87QmAhQJTfyvvoZ4YFPd722R2qRnXD/Giw==</code></p>\n",
            "combined_token_ids": "58065#, 1365556#, 1856#, 133609#, 20365#, 61336#, 61336, 133609, 2395988"
        }
    ],
    [
        {
            "Id": 37588950,
            "CreationDate": "2016-06-02T10:14:43Z",
            "Score": 0,
            "Title": "Too many Iif - Expression too complex in query expression - Alternative solutions?",
            "Body": "<p>I'm trying to count if a certain criteria is met, in this instance if RB is true, it should count it. \nI've got this to work the way it should, when I just had to count using a few Iif. </p>\n\n<p>However the below example exceeds the amount of Iif statements allowed (Getting the Expression is too complex in query expression). </p>\n\n<pre><code>SELECT Sanering_af_hoved_og_stikledninger.LedningsID, Sanering_af_hoved_og_stikledninger.OpstroemKnudeID, Sanering_af_hoved_og_stikledninger.OpstrmsKnudeNavn, Sanering_af_hoved_og_stikledninger.Opstrmsdybde, Sanering_af_hoved_og_stikledninger.NedstroemKnudeID, Sanering_af_hoved_og_stikledninger.Nedstrmsdybde, Sanering_af_hoved_og_stikledninger.NedstrmsKnudeNavn, Sanering_af_hoved_og_stikledninger.Laengde, Sanering_af_hoved_og_stikledninger.Handelsmaal, Sanering_af_hoved_og_stikledninger.Materiale, Sanering_af_hoved_og_stikledninger.TVObsKode,\n\nCount(IIf([TVObs].[TVObsKode]=\"RB\",\nTrue,IIf([TVObs].[TVObsKode]=\"OB\",\nTrue,IIf([TVObs].[TVObsKode]=\"PF\",\nTrue,IIf([TVObs].[TVObsKode]=\"DE\",\nTrue,IIf([TVObs].[TVObsKode]=\"FS\",\nTrue,IIf([TVObs].[TVObsKode]=\"IS\",\nTrue,IIf([TVObs].[TVObsKode]=\"R\",\nTrue,IIf([TVObs].[TVObsKode]=\"IN\",\nTrue,IIf([TVObs].[TVObsKode]=\"AF\",\nTrue,IIf([TVObs].[TVObsKode]=\"BE\",\nTrue,IIf([TVObs].[TVObsKode]=\"FO\",\nTrue,IIf([TVObs].[TVObsKode]=\"GR\",\nTrue,IIf([TVObs].[TVObsKode]=\"PH\",\nTrue,IIf([TVObs].[TVObsKode]=\"PB\",\nTrue,IIf([TVObs].[TVObsKode]=\"OS\",\nTrue,IIf([TVObs].[TVObsKode]=\"OP\",\nTrue,IIf([TVObs].[TVObsKode]=\"OK\",\nTrue,Null)))))))))))))))))) AS [Antal Observationer]\n\nFROM Rorenes_tilstand, Sanering_af_hoved_og_stikledninger\nGROUP BY Sanering_af_hoved_og_stikledninger.LedningsID, Sanering_af_hoved_og_stikledninger.OpstroemKnudeID, Sanering_af_hoved_og_stikledninger.OpstrmsKnudeNavn, Sanering_af_hoved_og_stikledninger.Opstrmsdybde, Sanering_af_hoved_og_stikledninger.NedstroemKnudeID, Sanering_af_hoved_og_stikledninger.Nedstrmsdybde, Sanering_af_hoved_og_stikledninger.NedstrmsKnudeNavn, Sanering_af_hoved_og_stikledninger.Laengde, Sanering_af_hoved_og_stikledninger.Handelsmaal, Sanering_af_hoved_og_stikledninger.Materiale, Sanering_af_hoved_og_stikledninger.TVObsKode\nORDER BY Sanering_af_hoved_og_stikledninger.LedningsID;\n</code></pre>\n\n<p>So my question is, is there another way of doing what I specified without using Iif? The below image shows the datasheet view, which counts in Antal Observationer (when there was only a few Iif)</p>\n\n<p><a href=\"http://i.stack.imgur.com/fBjej.png\" rel=\"nofollow\"><img src=\"http://i.stack.imgur.com/fBjej.png\" alt=\"AccessDatasheet\"></a></p>\n",
            "Tag": "ms-access,ms-access-2010,iif",
            "Answer": "<p>You can use someting like this for [Antal Observationer] column:</p>\n\n<pre><code>Sum(IIf([TVObs].[TVObsKode] IN (\"RB\",\"OB\",\"PF\",...\"OK\"),1,0)) AS [Antal Observationer]\n</code></pre>\n\n<p>But it would be better to store the list of codes in separate table and join main query with this table</p>\n",
            "combined_token_ids": "62741#, 138945#, 58065#, 1440#, 1883424#, 62741#, 669554#, 20365#, 265771#, 1883424#, 2435241#, 991901#, 1287922, 3255267, 58065"
        }
    ],
    [
        {
            "Id": 38360110,
            "CreationDate": "2016-07-13T19:25:03Z",
            "Score": 0,
            "Title": "how use IIF and Lookup & the Field! = \"Given String\" and return value from a field in same Dataset",
            "Body": "<p>In SSRS 2010, I have a large report with several Datasets and the report is group by Dept. from Dataset1. </p>\n\n<p>In Dataset2 I have Stored Proc that unions all the expenses from each dept for each month for CY_Daterange, PY_dateRange, CY_YTD and PY_YTD. The data returns something likes this:\n<a href=\"http://i.stack.imgur.com/vjlPW.gif\" rel=\"nofollow\">Dataset2</a>\nDataset1 has a field called Dept that I need to use a lookup to Dataset 2 Dept.,\nand in Dataset2 Descrp need to = \"PY_DR\" for the PY DR column and then return the fixed.value on the same row. See example pic:\n<a href=\"http://i.stack.imgur.com/cODhp.gif\" rel=\"nofollow\">Needs to return results simular</a></p>\n\n<p>I've tried to use the following expression: \n=IIF(Lookup(Fields!Level_4.Value,Fields!Level_4.Value, Fields!Descrp.Value, \"Expenses\")= \"PY_YTD\", \nLookup(Fields!Level_4.Value, Fields!Level_4.Value, Fields!Variable_Expenses.Value, \"Expenses\"),0) \nbut it returns a 0 because this part of the Lookup: Fields!Descrp.Value, \"Expenses\")= \"PY_YTD\", is only looking at the first row 'CY_DR'</p>\n\n<p>Also the report is grouped and each row in the tablix is a group row and not a detail row, not sure if that makes a difference. </p>\n\n<p>I can always split up the one stored proc (Dataset2) in to separate Stored Procs by Descrip Value, but I would prefer to use one since there is already so many for this Report. </p>\n\n<p>Thank you for any assistance you can provide.</p>\n",
            "Tag": "reporting-services,ssrs-2012,ssrs-tablix",
            "Answer": NaN,
            "combined_token_ids": "63853#, 60783#, 58065#, 57688#, 437394#, 1216#, 58632#, 240301#, 1952#, 18048#, 424185#, 440004#, 249936#, 136712#, 3104#, 240301#, 20365#, 129382#, 656733#, 9996237, 795851, 2344841"
        }
    ],
    [
        {
            "Id": 38916810,
            "CreationDate": "2016-08-12T11:23:19Z",
            "Score": 1,
            "Title": "MS Query Excel iif expression syntax error",
            "Body": "<p>Im using MS Query in Excel to execute the following query:</p>\n\n<pre><code>select \niif(egachid &lt;&gt;'GCAJA0', True, False)\nfrom fgledg\nwhere egcono='1'and egdivi='D30'and egvono=51166554\n</code></pre>\n\n<p>I have a tabel, fgledg, that contains a column, egchid. For a specific voucher (egvono = 51166554) I get the following rows:</p>\n\n<pre><code>EGCONO    EGDIVI    EGYEA4  EGVONO      EGCHID\n1         D30       2015    51166554    GCAJA0\n1         D30       2015    51166554    GCAJA0\n1         D30       2015    51166554    GCAJA0\n1         D30       2015    51166554    GCAJA0\n1         D30       2015    51166554    SEBSHHASP\n1         D30       2015    51166554    SEBSHHASP\n1         D30       2015    51166554    SEBSHHASP\n</code></pre>\n\n<p>I would like my query to return True if the column egchid contains other values than GCAJA0 and false if the column only contains the value GCAJA0, but I keep getting error messages no matter how i write the syntax. It seems to accept the iif function at least, but the syntax is incorrect?</p>\n\n<p>I have tried diffrent variations of writing the syntax, but get the following error messages:</p>\n\n<pre><code>IIf(egachid &lt;&gt;'GCAJA0', True, False)        Token &lt;&gt; was not valid\nIIf(egachid = 'GCAJA0', False, True)        Token = was not valid\nIIf([egachid] &lt;&gt;'GCAJA0', True, False)      Token [ was not valid\nIIf([egachid] &lt;&gt;'GCAJA0', 'True', 'False')  Token [ was not valid\n</code></pre>\n\n<p>What am I doing wrong?</p>\n",
            "Tag": "excel,ms-query",
            "Answer": "<p>Check your spelling of <code>egachid</code>. The column name is <code>EGCHID</code> -> no \"A\"\nElse you can try:</p>\n\n<pre><code>SELECT CASE WHEN egachid CONTAINS 'GCAJA0' THEN False ELSE True END AS name\n</code></pre>\n",
            "combined_token_ids": "21242#, 265771#, 245739#, 58065#, 1883424#, 438895#, 261729#, 245739, 963819"
        }
    ],
    [
        {
            "Id": 39263310,
            "CreationDate": "2016-09-01T05:27:14Z",
            "Score": 0,
            "Title": "ssrs dataset IIF condition not working",
            "Body": "<p>I can't figure out the syntax error in this statement,</p>\n\n<p><a href=\"http://i.stack.imgur.com/M8Y9p.png\" rel=\"nofollow\"><img src=\"http://i.stack.imgur.com/M8Y9p.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>\" &amp; IIF(Parameters!Product_type_name.Value&lt;&gt;\"AllType\",\"and product_type_name='\" &amp;  Parameters!Product_type_name.Value &amp; \"'\",\"\") &amp; \"\n</code></pre>\n\n<p>The logic is, if \"AllType\" is passed into the product_type_name, then we will have a product_type_name filter.</p>\n\n<p>Else, it will just return nothing.</p>\n\n<p>There seems to be something wrong with escape sequences.</p>\n\n<p><a href=\"http://i.stack.imgur.com/vtGoM.png\" rel=\"nofollow\"><img src=\"http://i.stack.imgur.com/vtGoM.png\" alt=\"enter image description here\"></a></p>\n",
            "Tag": "reporting-services,ssrs-2008",
            "Answer": "<p>That's not how to pass parameters to a SQL statement in SSRS</p>\n\n<p>eg: <code>y.facility = @Facility</code> will do</p>\n\n<p><a href=\"https://technet.microsoft.com/en-us/library/aa337432(v=sql.105).aspx\" rel=\"nofollow\">https://technet.microsoft.com/en-us/library/aa337432(v=sql.105).aspx</a></p>\n",
            "combined_token_ids": "142687#, 656733#, 58065#, 1363882#, 63577#, 138215#, 9996237, 808690"
        }
    ],
    [
        {
            "Id": 39792500,
            "CreationDate": "2016-09-30T13:17:35Z",
            "Score": 0,
            "Title": "SSRS IIF IsNothing Calculation",
            "Body": "<p>I have the following statement input as the background color of a cell which works fine, but if that cell is blank my code returns a shade of red.</p>\n\n<pre><code>=IIF(Fields!DBS_Next_Due___App_1.Value &lt;= Today(), \"#FF9696\", \n IIF(Fields!DBS_Next_Due___App_1.Value &lt;= dateadd(\"d\",180,Today()), \"#FFFF96\", \"White\"))\n</code></pre>\n\n<p>I tried to deal with the blanks with the  <code>isnothing</code> setting ,but i can't get the syntax correct. Any help would be appreciated</p>\n\n<pre><code>=IIF((IsNothing(Fields!DBS_Next_Due___App_1.Value &lt;= Today())  , #FF9696, \n   IIF(IsNothing(Fields!DBS_Next_Due___App_1.Value &lt;= dateadd(\"d\",180,Today())) , \"#FFFF96\",\n     AND NOT IsNothing(Fields!DBS_Next_Due___App_1.Value), \"WHITE\"))\n</code></pre>\n",
            "Tag": "reporting-services,iif,calc",
            "Answer": "<p>You simply need to check for null and OR it with the &lt;=.</p>\n\n<pre><code>IIF(IsNothing(Fields!xxx.Value) OR Fields!xxx.Value &lt;= Today())  \n</code></pre>\n",
            "combined_token_ids": "142687#, 58065#, 1355524#, 2428405#, 9996237, 58065, 126015"
        }
    ],
    [
        {
            "Id": 40048340,
            "CreationDate": "2016-10-14T16:54:40Z",
            "Score": 0,
            "Title": "LLVM how to get interprocedural analysis results from DSA (Poolalloc)",
            "Body": "<p>I am using the data structure analysis (DSA) from LLVM's Poolalloc in my compiler pass as points-to analysis. For each function I get a points-to graph using the getDSGraph() API. However this graph is only intraprocedural and not interprocedural. I am using the EQTDDataStructures pass.</p>\n\n<p>I guess that I need to merge these graphs for each function call. However, I am not sure how to do this.</p>\n\n<p>How do I get the interprocedural results from the DSA analysis? </p>\n",
            "Tag": "llvm",
            "Answer": NaN,
            "combined_token_ids": "138579#, 63853#, 21183#, 61049#, 5986169#, 990388#, 440561#, 136712#, 58065#, 1280#, 138579"
        }
    ]
]